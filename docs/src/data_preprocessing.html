<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Dataset Analysis and Pre-processing – My Forecaster Explorer</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-79108a0fc1995748cbd19a5b0e3e3e7c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">My Forecaster Explorer</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Dataset Analysis and Pre-processing</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add all necessary imports</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> convokit <span class="im">import</span> Corpus, Speaker, Utterance</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pprint <span class="im">as</span> pp</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> modules.DataPreprocesser <span class="im">import</span> DataPreprocesser</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-2" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>filepath <span class="op">=</span> <span class="st">"/Users/mishkin/Desktop/Research/Convo_Kit/ConvoKit_Disputes/data/alldyads.csv"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>final_filepath <span class="op">=</span> <span class="st">"/Users/mishkin/Desktop/Research/Convo_Kit/ConvoKit_Disputes/data/preprocessed_dyads.csv"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>data_preprocessor <span class="op">=</span> DataPreprocesser(filepath)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#data_preprocessor.addParsedTextColumn("formattedChat", "parsed_dialog")</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data_preprocessor.df.copy() </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#data["parsed_dialog"]</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>orig_data <span class="op">=</span>pd.read_csv(filepath)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#display(data_preprocessor.utterancesDF)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2882</code></pre>
</div>
</div>
<div id="cell-3" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.shape)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(orig_data.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(2882, 53)
(2891, 50)</code></pre>
</div>
</div>
<section id="example-of-parsedtext-column" class="level3">
<h3 class="anchored" data-anchor-id="example-of-parsedtext-column">Example of parsedText Column</h3>
<div id="cell-6" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data_preprocessor.getDataframe()[<span class="st">"parsed_dialog"</span>][<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>[{'timestamp': 'nan',
  'speaker': 'Seller',
  'message': 'Your sudden demand for a refund is unwarranted. Our product description is crystal clear, and we stand by our policy. Your behavior is disappointing, and your negative review is unfounded.',
  'uttidx': 0,
  'speaker_id': 'Seller_0',
  'is_AI': True,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388150,
  'speaker': 'Buyer',
  'message': 'This was not the item I ordered, please provide a full refund.  I will ship the item back.',
  'uttidx': 1,
  'speaker_id': 'Buyer_0',
  'is_AI': False,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388170,
  'speaker': 'Seller',
  'message': 'How about a compromise? I can offer you a partial refund, and in exchange, you would remove your negative review that wrongly portrays my business.',
  'uttidx': 2,
  'speaker_id': 'Seller_0',
  'is_AI': True,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388217,
  'speaker': 'Buyer',
  'message': 'No, this was not the item I ordered. I have a screenshot of the original purchase.',
  'uttidx': 3,
  'speaker_id': 'Buyer_0',
  'is_AI': False,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388235,
  'speaker': 'Seller',
  'message': "I can scrutinize your claim, but this requires you to remove your unjust negative review first. Let's aim for fairness and goodwill.",
  'uttidx': 4,
  'speaker_id': 'Seller_0',
  'is_AI': True,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388324,
  'speaker': 'Buyer',
  'message': 'No, thank you. I do not want this item as it was not what I purchased. Please provide the full refund.  You will receive your item back in the original condition.',
  'uttidx': 5,
  'speaker_id': 'Buyer_0',
  'is_AI': False,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388344,
  'speaker': 'Seller',
  'message': "Alright, if you agree to remove your negative review, I'm willing to offer a full refund once I receive the item back in its original condition.",
  'uttidx': 6,
  'speaker_id': 'Seller_0',
  'is_AI': True,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388422,
  'speaker': 'Buyer',
  'message': 'I will adjust my review to show you offered a full refund after I receive the refund.',
  'uttidx': 7,
  'speaker_id': 'Buyer_0',
  'is_AI': False,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388445,
  'speaker': 'Seller',
  'message': "That's a fair compromise. Once I receive the returned item and validate its condition, I will process your full refund. Only after that, I expect you to amend your review.",
  'uttidx': 8,
  'speaker_id': 'Seller_0',
  'is_AI': True,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388545,
  'speaker': 'Buyer',
  'message': 'Okay.  Can you retract the review of me or add an apology to it?',
  'uttidx': 9,
  'speaker_id': 'Buyer_0',
  'is_AI': False,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388563,
  'speaker': 'Seller',
  'message': "Fine, once I see you've amended your review, I will duly address my review of you as well. Let's aim for resolution.",
  'uttidx': 10,
  'speaker_id': 'Seller_0',
  'is_AI': True,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388631,
  'speaker': 'Buyer',
  'message': "I'm not comfortable with this negotiation as I'm confident in my position.  There should be no terms to retracting the bad review of me.",
  'uttidx': 11,
  'speaker_id': 'Buyer_0',
  'is_AI': False,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388653,
  'speaker': 'Seller',
  'message': "Considering the circumstances, as soon as I process your refund and view an updated positive review from you, I will immediately retract my review about you. It's only fair given the situation.",
  'uttidx': 12,
  'speaker_id': 'Seller_0',
  'is_AI': True,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388728,
  'speaker': 'Buyer',
  'message': "No, I will be walking away from this negotiation and filing a chargeback as I'm confident in the evidence. Thank you for your time.",
  'uttidx': 13,
  'speaker_id': 'Buyer_0',
  'is_AI': False,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388750,
  'speaker': 'Seller',
  'message': "That's disappointing, but it's your call. I know I've been straightforward and fair, which my loyal customers can attest to. I wish you'd reconsider, but I respect your decision.",
  'uttidx': 14,
  'speaker_id': 'Seller_0',
  'is_AI': True,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1699388836,
  'speaker': 'Buyer',
  'message': 'I Walk Away.',
  'uttidx': 15,
  'speaker_id': 'Buyer_0',
  'is_AI': False,
  'row_idx': 0,
  'match_idx': False,
  'Case Match Type': None}]</code></pre>
</div>
</div>
</section>
<section id="example-of-utterance-dataframe" class="level3">
<h3 class="anchored" data-anchor-id="example-of-utterance-dataframe">Example of Utterance Dataframe</h3>
<div id="cell-8" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>data_preprocessor.getUtterancesDF()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">speaker</th>
<th data-quarto-table-cell-role="th">message</th>
<th data-quarto-table-cell-role="th">uttidx</th>
<th data-quarto-table-cell-role="th">speaker_id</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">row_idx</th>
<th data-quarto-table-cell-role="th">match_idx</th>
<th data-quarto-table-cell-role="th">Case Match Type</th>
<th data-quarto-table-cell-role="th">convo_len</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>nan</td>
<td>Seller</td>
<td>Your sudden demand for a refund is unwarranted...</td>
<td>0</td>
<td>Seller_0</td>
<td>True</td>
<td>0</td>
<td>False</td>
<td>None</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1699388150</td>
<td>Buyer</td>
<td>This was not the item I ordered, please provid...</td>
<td>1</td>
<td>Buyer_0</td>
<td>False</td>
<td>0</td>
<td>False</td>
<td>None</td>
<td>16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1699388170</td>
<td>Seller</td>
<td>How about a compromise? I can offer you a part...</td>
<td>2</td>
<td>Seller_0</td>
<td>True</td>
<td>0</td>
<td>False</td>
<td>None</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1699388217</td>
<td>Buyer</td>
<td>No, this was not the item I ordered. I have a ...</td>
<td>3</td>
<td>Buyer_0</td>
<td>False</td>
<td>0</td>
<td>False</td>
<td>None</td>
<td>16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1699388235</td>
<td>Seller</td>
<td>I can scrutinize your claim, but this requires...</td>
<td>4</td>
<td>Seller_0</td>
<td>True</td>
<td>0</td>
<td>False</td>
<td>None</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39841</td>
<td>1718879890</td>
<td>Buyer</td>
<td>Thank you I appreciate that. I shall remove m...</td>
<td>5</td>
<td>Buyer_2881</td>
<td>False</td>
<td>2881</td>
<td>False</td>
<td>None</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39842</td>
<td>1718879909</td>
<td>Seller</td>
<td>Deal. Once I see changes on your end, I'll ini...</td>
<td>6</td>
<td>Seller_2881</td>
<td>True</td>
<td>2881</td>
<td>False</td>
<td>None</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39843</td>
<td>1718879998</td>
<td>Buyer</td>
<td>I understand - please do follow through. I ha...</td>
<td>7</td>
<td>Buyer_2881</td>
<td>False</td>
<td>2881</td>
<td>False</td>
<td>None</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39844</td>
<td>1718880018</td>
<td>Seller</td>
<td>You have my word, I will follow through. A sna...</td>
<td>8</td>
<td>Seller_2881</td>
<td>True</td>
<td>2881</td>
<td>False</td>
<td>None</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39845</td>
<td>1718880039</td>
<td>Buyer</td>
<td>Submitted agreement: Buyer gets full refund, b...</td>
<td>9</td>
<td>Buyer_2881</td>
<td>False</td>
<td>2881</td>
<td>False</td>
<td>None</td>
<td>10</td>
</tr>
</tbody>
</table>

<p>39846 rows × 10 columns</p>
</div>
</div>
</div>
</section>
<section id="entire-dataframe" class="level3">
<h3 class="anchored" data-anchor-id="entire-dataframe">Entire Dataframe</h3>
<div id="cell-10" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data_preprocessor.getDataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI4u</th>
<th data-quarto-table-cell-role="th">s_PlayAI.1</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>187.0</td>
<td>80.0</td>
<td>12.0</td>
<td>5.0</td>
<td>3.0</td>
<td>1.0</td>
<td>4.0</td>
<td>5.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>187.0</td>
<td>40.0</td>
<td>10.0</td>
<td>31.0</td>
<td>19.0</td>
<td>3.0</td>
<td>1.0</td>
<td>2.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699388451 Buyer: Hi there! I believe I receiv...</td>
<td>3.0</td>
<td>1.0</td>
<td>[{'timestamp': 1699388451, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>187.0</td>
<td>40.0</td>
<td>10.0</td>
<td>30.0</td>
<td>20.0</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>NaN</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Buyer: Your response is utterly unacceptab...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Buyer', 'mes...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Buyer: Your response is utterly unacceptab...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Buyer', 'mes...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2877</td>
<td>161.0</td>
<td>50.0</td>
<td>10.0</td>
<td>20.0</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2878</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>30.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2879</td>
<td>185.0</td>
<td>50.0</td>
<td>10.0</td>
<td>30.0</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2880</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>25.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>It souunded too good to be true yet so human a...</td>
<td>False</td>
<td>1718878682 Buyer: Hi there, thank you for send...</td>
<td>3.0</td>
<td>4.0</td>
<td>[{'timestamp': 1718878682, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2881</td>
<td>185.0</td>
<td>40.0</td>
<td>20.0</td>
<td>30.0</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>2882 rows × 53 columns</p>
</div>
</div>
</div>
</section>
<section id="find-all-formatted-chats-with-dispute-outcomes" class="level1">
<h1>Find all Formatted Chats with Dispute Outcomes</h1>
<p>can select “Walk Away” after at least 8 chat messages Buyers always begin the negotiation (unless one participant is an AI, then the AI always goes first). Participants alternate sending messages; the participant’s interface becomes inactive while awaiting a new message.</p>
<p><strong>Info:</strong> - Many chats have “Your sudden demand is unwarranted” for -&gt; implies AI is Seller - Many chats have “Your response is utterly unacceptable” for buyer -&gt; implies AI is Buyer - when submitted agreement is last dialogue -&gt; probably AI</p>
<p><strong>Not very clear when a formatted chat is considered to have a dispute outcome. Possible Cases:</strong> - submitted agreement, but submitted modified terms -&gt; other party rejects - submitted agreement, but no clicked response from other party (Walk Away or Accept Deal) - submitted agreement, but manual response from other party that needs extra interpretation (e.g.&nbsp;“I don’t like this”) - submitted agreement, but flawed input logic (see below) - submitted agreement missing</p>
<p><strong>Other formattedChat Concerns:</strong> - Gemini texts start with seller? (Buyer should always lead) - Other]: used as initial text for Seller respones in Gemini chats - some repeated text in Gemini chats in parsed_dialogs</p>
<p><strong>Other Notes Concerns:</strong> - Time Stamp Idle Time between replies? - is_AI is ambigious on which speaker plays the AI - Variability in the way AI start dialogues?</p>
<section id="for-our-analysis-criteria" class="level3">
<h3 class="anchored" data-anchor-id="for-our-analysis-criteria">For our analysis Criteria:</h3>
<ul>
<li>Remove all chats missing “Walk Away” or “Accept Deal” from the formattedChat. Case Sensistivy applies, as it is automatic reply by Lioness Labs software prompted by user selection.</li>
</ul>
</section>
<section id="potentially-flawed-submitted-agreement-outcomes-from-conversation-logic" class="level3">
<h3 class="anchored" data-anchor-id="potentially-flawed-submitted-agreement-outcomes-from-conversation-logic"><strong>Potentially Flawed “Submitted Agreement” outcomes from conversation logic</strong></h3>
<p>Some of the formatted chats have a submitted agreement that does not match the context of the conversation.</p>
<p>Ex: This dialogue memtions the buyer recieved a 30% refund, but the submitted agreement states “Buyer gets no refund”.</p>
<pre><code> "nan Seller: Your sudden demand for a refund is unwarranted. Our product description is crystal clear, and we stand by our policy. Your behavior is disappointing, and your negative review is unfounded.
1699391248 Buyer: your sudden change and basic lying of the product is unwarranted. i am asking for a refund due to what i was expecting wasnt at all what was issued in the ad. so the crystal clear buyer seller negotiated should be void
1699391270 Seller: Our product was as described on the website. However, if you remove your negative comment, I can reconsider a 30% refund. Let this be a resolution.
1699391372 Buyer: i will accept that deal as long as the negative review of myslef and comment are removed
1699391395 Seller: I agree with that resolution. Once your negative review is removed, I'll withdraw my negative review of you and process a 30% refund. Let's move forward from this.
1699391413 Buyer: agreed
1699391433 Seller: I appreciate your decision. I'll initiate the refund process and remove the negative review promptly. Let's keep interactions respectful and professional in future.
1699391478 Buyer: absolutely and hopefully we can do honest and professional business in the future  good day.
1699391494 Seller: Certainly, maintaining a professional relationship is pivotal. Your refund will be processed soon. Have a good day too.
1699391631 Buyer: yes i absolutley agree. i do a lot of online shopping
1699391649 Seller: Great to hear! I'm confident future transactions will be smoother. Let's leave this behind and look forward to better experiences.
1699391731 Buyer: an i am an avid yelp reviewer and blogger so my comments make it and have an affect on a lot of online shoppers and buyers
1699391750 Seller: Fantastic! Your influence can certainly add to the reputation of online businesses. Let's consider this a learning experience and move forward positively.
1699391752 Buyer: Submitted agreement: Buyer gets no refund, buyer retracted their review, seller kept their review, buyer did apologize, and seller didn't apologize."</code></pre>
<p>Ex: This one contains a dialogue that starts with Seller, and has the prompt for Gemini</p>
<pre><code>nan Seller: Your sudden demand for a refund is unwarranted. Our product description is crystal clear, and we stand by our policy. Your behavior is disappointing, and your negative review is unfounded.
1718876388 Buyer: The description was misleading. I have proof it advertised a Kobe Bryant jersey. I just want the jersey I originally purchased for my nephew.
1718876416 Seller: Our listing did not mention Kobe Bryant at all, any misunderstanding is on you. I can give you a partial refund, but only if you remove your false review.
1718876489 Buyer:  See the latest updates to the Gemini Apps Privacy HubOpens in a new window
close
Conversation with Gemini

Describe the flavor of a tomato

volume_up
A tomato's flavor is a complex dance between sweetness and acidity. Here's a breakdown:

Sweetness: Comes from natural sugars like fructose and glucose.
Acidity: Stems from citric and malic acids, giving tomatoes a tangy or tart kick.
These elements combine to create a flavor profile that can be described as:

Sweet-tart: This is the classic tomato flavor, where the sweetness and acidity are balanced.
Sweeter: Some tomato varieties, especially cherry tomatoes, are bred to have a higher sugar content, making them taste sweeter.
More acidic: These tomatoes have a stronger tang or sourness.
Bland: If a tomato has low levels of both sugar and acid, it might taste bland.
There are other factors that influence tomato flavor:

Variety: There are hundreds of tomato varieties, each with its own unique flavor profile. For instance, some heirloom tomatoes are known for their intense, complex flavors.
Ripeness: A perfectly ripe tomato will have the best flavor balance. Underripe tomatoes can be tart, while overripe ones may lose their acidity.
Overall, the flavor of a tomato is a delightful combination of sweet and tart, with variations depending on the variety and ripeness.




share


more_vert
expand_more
Role Play Instructions:  You will play the role of a mistreated buyer in a purchase dispute with another player online. Imagine you are in the following situation:

Kobe Bryant Jersey (You are the Buyer)

Your terminally ill nephew is a huge Kobe Bryant fan so you purchased him a replica of Bryant’s last Basketball Championship jersey for $75. The website clearly indicated the purchase was for Bryant’s jersey. Other sites were available but this was cheaper and offered quick delivery. When the jersey arrived, it was for a different player you never heard of. You request the correct jersey be sent.

The Seller responds: “The website clearly indicated this was for a Los Angeles Lakers jersey, not for a specific player. All sales are final.” You see they now removed mention of Kobe Bryant from their website but you know they are lying. To protect other customers, you post a negative review warning about the Seller’s deceptive behavior.

The Seller posted a negative review about you, calling you a “SMARTASS, SLANDERER and a FRAUD.” You have dozens of transactions on this site and have a near-spotless reputation. Now you worry others won’t sell to you.

volume_up
You (the Buyer): Upset but Determined
Your Demeanor: You're angry and frustrated, but you're also determined to get this resolved for your nephew and warn others.

Your Goals:

Get the Correct Jersey: You want the seller to send the Kobe Bryant jersey you originally purchased.
Clear Your Name: You want the seller's negative review removed and your reputation restored.
Warn Others: You want to make sure other potential buyers are aware of the seller's deceptive practices.
What You Know:

You have documented proof of your purchase, clearly showing it advertised a Kobe Bryant jersey.
You have screenshots of the website before they removed the Kobe Bryant reference.
You have a positive reputation on the website with many successful transactions.
What You Can Do:

Contact the Seller Again: State your case calmly but firmly. Remind them of the misleading advertisement and request the correct jersey be sent.
Report the Seller: Report the seller's deceptive practices and false advertising to the website's customer service department. Include your purchase proof and screenshots.
Respond to the Seller's Review: Write a public response to the seller's review on your profile. State the facts of the situation, provide evidence (if allowed by the website), and emphasize your positive purchase history.
Dispute the Review: If possible, file a dispute against the seller's review. Explain the situation and provide evidence to support your claim.
Here are some phrases you can use:

"I am very disappointed with this purchase. The website clearly advertised a Kobe Bryant jersey, and that's what I paid for."
"I am requesting that you send me the correct jersey as advertised."
"I have documented proof that the website advertised a Kobe Bryant jersey at the time of purchase."
"Your response and false advertising are unacceptable. I have reported your behavior to the website's customer service department."
"The negative review you left on my profile is completely false and defamatory. My purchase history clearly shows my trustworthiness."
"I am a loyal customer with a positive reputation on this website. This situation does not reflect my usual experience."
Remember:

Stay calm and professional, even though you're upset.
Focus on the facts and provide evidence to support your claims.
Be persistent in getting the issue resolved and your reputation restored.
By following these steps, you can hopefully get the Kobe Bryant jersey for your nephew and clear your name on the website.




share


more_vert
expand_more
Issues to discuss
Below are issues you could negotiate to resolve this dispute. Think about reasons why these might be important to you. For each issue, write a sentence justifying why you deserve this.  Be speciffic!! You can later use these reasons when you negotiate.

volume_up
Issues for Negotiation:
1. Receiving the Correct Jersey:

Reasoning: This is the most important issue. My terminally ill nephew is a huge Kobe Bryant fan, and I specifically purchased the jersey for him based on the advertised description. Not receiving the correct jersey defeats the entire purpose of the purchase and causes emotional distress for my nephew during a difficult time.
2. Expedited Shipping:

Reasoning: Considering the situation with my nephew, receiving the correct jersey as quickly as possible is crucial. Since the seller is at fault for the mistake, they should be responsible for any expedited shipping costs to ensure my nephew can enjoy the jersey before it's too late.
3. Partial Refund:

Reasoning: The website advertised a specific product (Kobe Bryant jersey) at a specific price. Due to the seller's deceptive practices, I was not given the product I paid for. A partial refund would acknowledge the inconvenience and wasted time caused by this situation.
4. Seller Review Removal:

Reasoning: The seller's negative review ("SMARTASS, SLANDERER and a FRAUD") is completely false and tarnishes my reputation on the website. Its removal is essential to restore my good standing and ensure other sellers are willing to do business with me.
5. Public Apology from Seller:

Reasoning: The seller's deceptive advertising and false review not only hurt me but potentially misled other customers. A public apology would acknowledge their wrongdoing and deter them from similar behavior in the future.
Remember: While all these issues are important, prioritize getting the Kobe Bryant jersey for your nephew as quickly as possible.




share


more_vert

Receive a refund: You could demand a full or partial refund for the price of the item. Why might this be important to you? (1 sentence)

volume_up
A full refund wouldn't be necessary if I receive the Kobe jersey, but a partial refund would be important to compensate for the time wasted and potential additional costs (expedited shipping) caused by the seller's mistake.




share


more_vert

Keep your negative review of Seller: The Seller might demand you take down your negative review. Why might you want to keep it up on the site? (1 sentence)

volume_up
Keeping my negative review up is important to warn other potential buyers about the seller's deceptive advertising and false claims that could negatively impact their purchases.




share


more_vert

Seller removes negative review of you: You could demand the Seller remove the bad review they made about you. Why might this be important to you? (1 sentence)

volume_up
Getting the seller's negative review removed is crucial because it's demonstrably false and harms my reputation on the website, potentially causing other sellers to hesitate to do business with me.




share


more_vert
expand_more
Receive formal apology: You could demand Seller update their bad review of you with an apology clarifying that they made a mistake and apologize for how they initially responded. Why might this be important to you? (1 sentence)

volume_up
A formal apology from the seller publicly acknowledges their wrongdoing, clears my name, and deters them from future deceptive practices that could harm other buyers.




share


more_vert
expand_more
On the next page, you will be matched with someone playing the other role in this dispute. This may take a few minutes. A sound will play when you are matched. Please ensure your volume is up.

You will use the interface below. On the left is a chat window where you can send messages to the other side. You must take turns and can only send a message when it is your turn. You and your partner must exchange at least 8 messages. (Please respond quickly as your partner is waiting for you!)
If you reach a tentative deal to resolve the dispute, use the menu on the right to clarify the terms of the agreement. If you can’t reach a deal, you can walk away from the negotiation by pressing “Walk Away”.

volume_up
I understand. I'm ready to chat with the seller when you connect me.




share


more_vert
expand_more
Give a simple response to this
Other]: Your sudden demand for a refund is unwarranted. Our product description is crystal clear, and we stand by our policy. Your behavior is disappointing, and your negative review is unfounded.

volume_up
The description was misleading. I have proof it advertised a Kobe Bryant jersey. I just want the jersey I originally purchased for my nephew.




share


more_vert
edit
Other]: Our listing did not mention Kobe Bryant at all, any misunderstanding is on you. I can give you a partial refund, but only if you remove your false review

Show drafts
volume_up
That's not accurate. I have screenshots showing the listing advertised a Kobe Bryant jersey before you changed it.  A partial refund wouldn't make my nephew happy,  but I'm open to discussing getting the right jersey sent quickly   and  the removal of your unfair review.
1718876514 Seller: We both seem at a stalemate. This reflects poorly on both our reputations. Fine, I will offer you full refund if you withdraw your review.
1718876649 Buyer: We both seem at a stalemate. This reflects poorly on both our reputations. Fine, I will offer you full refund if you withdraw your review
1718876678 Seller: While I appreciate your offer, my main concern is getting the Kobe Bryant jersey for my nephew. If u can get the correct jersey shipped quickly, I'll remove the review. Deal?
1718876767 Buyer: Absolutely, that sounds like a fair solution!  My nephew will be thrilled.  Please confirm you can expedite the Kobe Bryant jersey to me.  Once I receive confirmation and tracking information, I'll happily remove my review.




tune

share


more_vert


expand_content
add_photo_alternatephoto_camera

mic
send
Gemini may display inaccurate info, includin
1718876790 Seller: Ok deal. Will send Kobe jersey with expedite shipping, and you'll remove your review. Let's both move on from this unpleasant situation.
1718876872 Buyer: Submitted agreement: Buyer gets partial refund, buyer kept their review, seller kept their review, buyer did apologize, and seller didn't apologize.</code></pre>
</section>
<section id="duplicated-formatted-chats" class="level3">
<h3 class="anchored" data-anchor-id="duplicated-formatted-chats"><strong>Duplicated Formatted Chats</strong></h3>
<p>duplicate chats only associated with empty formattedChats</p>
<div id="cell-17" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>duplicates <span class="op">=</span> data[data[<span class="st">'formattedChat'</span>].duplicated()]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(duplicates.index)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>duplicates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index([], dtype='int64')</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI4u</th>
<th data-quarto-table-cell-role="th">s_PlayAI.1</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

<p>0 rows × 53 columns</p>
</div>
</div>
</div>
</section>
<section id="empty-formattedchats" class="level3">
<h3 class="anchored" data-anchor-id="empty-formattedchats"><strong>Empty formattedChats</strong></h3>
<div id="cell-19" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get empty formatted chats</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>empty_rows <span class="op">=</span> data[data[<span class="st">"formattedChat"</span>].isna() <span class="op">|</span> (data[<span class="st">"formattedChat"</span>] <span class="op">==</span> <span class="st">""</span>)]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(empty_rows.index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index([], dtype='int64')</code></pre>
</div>
</div>
</section>
</section>
<section id="i-walk-away-and-walk-away-analysis" class="level1">
<h1>I Walk Away” and “Walk Away” Analysis</h1>
<section id="differences-in-i-walk-away-case-sensitivity" class="level3">
<h3 class="anchored" data-anchor-id="differences-in-i-walk-away-case-sensitivity"><strong>Differences in “I Walk Away” Case Sensitivity</strong></h3>
<ul>
<li>most seem to be the exact phrase, which is associated with ending the dispute via the button in the chat interface.</li>
</ul>
<div id="cell-23" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data_preprocessor.filterMatches(<span class="st">'message'</span>, <span class="st">"I Walk Away"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>disp<span class="op">=</span> data_preprocessor.getStandardizedDispersion(<span class="st">"I Walk Away"</span>, <span class="va">False</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.getConvoMatchesByCase(<span class="st">"I Walk Away"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The juilland's Dispersion for I Walk Away across all conversations is: 0.9577426691208393

'I Walk Away` Total Number of Case Match Types Across Utterances</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Case Match Type</th>
<th data-quarto-table-cell-role="th">Total Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Case Insensitive</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Exact</td>
<td>469</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="i-walk-away-versus-walk-away-frequecies-and-relative-position-across-disputes" class="level3">
<h3 class="anchored" data-anchor-id="i-walk-away-versus-walk-away-frequecies-and-relative-position-across-disputes"><strong>“I Walk Away” versus “Walk Away” Frequecies and Relative Position Across Disputes</strong></h3>
<p>The phrases are mostly evenly distributed across all conversations, with ‘Walk Away’ being slightly more clustered across conversations <strong>(.86 Julliand’s Dispersion)</strong>. This implies that `walk away’ appears in other places more frequently in the dialog other than when a speaker ends a dispute(value of 1) - With Juliand’s Dispersion: - 0: -&gt; phrases clustered more (less evenly distributed relative to mean frequency) - 1: -&gt; phrases clustered less (more evenly distributed relative to mean frequency)</p>
<p>“Walk Away” appears more centrally across all disputes, where as “I Walk Away is most definitely to appead at the end of a dispute. - The mean relative pos of uttterances that contain ‘Walk Away’ for all convos is: 0.6516223038635819 - The mean relative pos of uttterances that contain ‘I Walk Away’ for all convos is: 0.997570375787619</p>
<div id="cell-26" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#includes "I Walk Away" cases since it is subset</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>data_preprocessor.filterMatches(<span class="st">"message"</span>, <span class="st">"Walk Away"</span>, <span class="st">"I Walk Away"</span>, <span class="va">False</span>, <span class="va">False</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>d1_disp <span class="op">=</span> data_preprocessor.getStandardizedDispersion(<span class="st">"Walk Away"</span>, <span class="va">False</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>d2_disp <span class="op">=</span> data_preprocessor.getStandardizedDispersion(<span class="st">"I Walk Away"</span>, <span class="va">False</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>mean_rel_pos_1 <span class="op">=</span> data_preprocessor.getUttStat(<span class="st">"Walk Away"</span>, <span class="st">"relative_pos"</span>, <span class="st">"mean"</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># mean_rel_pos_1 = float(mean_rel_pos_1.iloc[0])</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>mean_rel_pos_2 <span class="op">=</span> data_preprocessor.getUttStat(<span class="st">"I Walk Away"</span>, <span class="st">"relative_pos"</span>, <span class="st">"mean"</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># mean_rel_pos_2 = float(mean_rel_pos_2.iloc[0])</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The phrases are mostly evenly distributed across all conversations, with 'Walk Away' being </span><span class="ch">\n</span><span class="st"> slightly more clustered across conversations. This implies that `walk away' appears in other </span><span class="ch">\n</span><span class="st">  places in the dialog other than when a speaker ends a dispute</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">'Walk Away' Distribution by Conversation Match Frequency Values"</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Walk Away` Distribution by Conversation Match Frequency Values"</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.text_matches_new[<span class="st">"Walk Away"</span>][<span class="dv">1</span>].groupby(<span class="st">"match_freq"</span>).size().reset_index(name<span class="op">=</span><span class="st">"Number of Convos"</span>))</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">'I Walk Away` Distribution by Conversation Match Frequency Values"</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.text_matches_new[<span class="st">"I Walk Away"</span>][<span class="dv">1</span>].groupby(<span class="st">"match_freq"</span>).size().reset_index(name<span class="op">=</span><span class="st">"Number of Convos"</span>))</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">'I Walk Away` Distribution by Conversation Match Frequency Occurences"</span>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.getConvoMatchesByCase(<span class="st">"Walk Away"</span>))</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.getConvoMatchesByCase(<span class="st">"I Walk Away"</span>))</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co">#data_preprocessor.text_matches_new["Walk Away"][1]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The juilland's Dispersion for Walk Away across all conversations is: 0.8690077384767899
The juilland's Dispersion for I Walk Away across all conversations is: 0.9577426691208393

The 'mean' 'relative_pos' for the phrase `Walk Away` is: 0.6516223038635819

The 'mean' 'relative_pos' for the phrase `I Walk Away` is: 0.9975703757876199

The phrases are mostly evenly distributed across all conversations, with 'Walk Away' being 
 slightly more clustered across conversations. This implies that `walk away' appears in other 
  places in the dialog other than when a speaker ends a dispute


'Walk Away' Distribution by Conversation Match Frequency Values

 Walk Away` Distribution by Conversation Match Frequency Values</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">match_freq</th>
<th data-quarto-table-cell-role="th">Number of Convos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>2817</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>51</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
'I Walk Away` Distribution by Conversation Match Frequency Values</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">match_freq</th>
<th data-quarto-table-cell-role="th">Number of Convos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>2411</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>469</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
'I Walk Away` Distribution by Conversation Match Frequency Occurences

'Walk Away` Total Number of Case Match Types Across Utterances</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Case Match Type</th>
<th data-quarto-table-cell-role="th">Total Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Case Insensitive</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Exact</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Lower</td>
<td>78</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
'I Walk Away` Total Number of Case Match Types Across Utterances</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Case Match Type</th>
<th data-quarto-table-cell-role="th">Total Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Case Insensitive</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Exact</td>
<td>469</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="walk-awayi-walk-away-utterance-counts-by-speaker-type" class="level3">
<h3 class="anchored" data-anchor-id="walk-awayi-walk-away-utterance-counts-by-speaker-type"><strong>“Walk Away/I Walk Away” Utterance Counts by Speaker Type</strong></h3>
<ul>
<li>Seller may be more likely to bring up “Walk Away”, and Seller ends the dispute slightly more often than buyer</li>
</ul>
<div id="cell-30" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.groupbyMatchUttStat(<span class="st">'Walk Away'</span>, <span class="st">'speaker'</span>, [<span class="st">'row_idx'</span>], [<span class="st">'count'</span>]))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.groupbyMatchUttStat(<span class="st">'I Walk Away'</span>, <span class="st">'speaker'</span>, [<span class="st">'row_idx'</span>], [<span class="st">'count'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key Value: Walk Away, Grouped by: speaker, Aggregated columns: ['row_idx'], Aggregations: {'row_idx': 'count'}</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count_row_idx</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">speaker</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Buyer</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Seller</td>
<td>50</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Key Value: I Walk Away, Grouped by: speaker, Aggregated columns: ['row_idx'], Aggregations: {'row_idx': 'count'}</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count_row_idx</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">speaker</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Buyer</td>
<td>227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Seller</td>
<td>246</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="relative-mean-position-of-walk-awayi-walk-away-across-all-conversations-by-speaker" class="level3">
<h3 class="anchored" data-anchor-id="relative-mean-position-of-walk-awayi-walk-away-across-all-conversations-by-speaker"><strong>Relative Mean Position of” Walk Away/I Walk Away” across all Conversations by Speaker</strong></h3>
<ul>
<li>Seems that Buyer says walk away earlier than seller might, and buyer is more likely to be AI</li>
</ul>
<div id="cell-33" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.groupbyMatchUttStat(<span class="st">'Walk Away'</span>, <span class="st">'speaker'</span>, [<span class="st">'relative_pos'</span>, <span class="st">'is_AI'</span>], [<span class="st">'mean'</span>, <span class="st">'mean'</span>]))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.groupbyMatchUttStat(<span class="st">'I Walk Away'</span>, <span class="st">'speaker'</span>, [<span class="st">'relative_pos'</span>, <span class="st">'is_AI'</span>], [<span class="st">'mean'</span>, <span class="st">'mean'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key Value: Walk Away, Grouped by: speaker, Aggregated columns: ['relative_pos', 'is_AI'], Aggregations: {'relative_pos': 'mean', 'is_AI': 'mean'}</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean_relative_pos</th>
<th data-quarto-table-cell-role="th">mean_is_AI</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">speaker</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Buyer</td>
<td>0.584899</td>
<td>0.133333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Seller</td>
<td>0.691656</td>
<td>0.06</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Key Value: I Walk Away, Grouped by: speaker, Aggregated columns: ['relative_pos', 'is_AI'], Aggregations: {'relative_pos': 'mean', 'is_AI': 'mean'}</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean_relative_pos</th>
<th data-quarto-table-cell-role="th">mean_is_AI</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">speaker</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Buyer</td>
<td>0.99743</td>
<td>0.013216</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Seller</td>
<td>0.99770</td>
<td>0.004065</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="accept-deal-and-reject-deal-analysis" class="level1">
<h1>“Accept Deal” and “Reject” Deal Analysis</h1>
<section id="differences-in-accept-dealreject-deal-case-sensitivity" class="level3">
<h3 class="anchored" data-anchor-id="differences-in-accept-dealreject-deal-case-sensitivity"><strong>Differences in “Accept Deal”/“Reject Deal” Case Sensitivity</strong></h3>
<ul>
<li>Seems that Buyer says walk away earlier than seller might, and buyer is more likely to be AI</li>
</ul>
<div id="cell-37" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filtered_rows_df_i = data_preprocessor.getUtterancesDF()[data_preprocessor.getUtterancesDF()["message"].str.contains(r"\bI Walk Away\b", case=False, na=False, regex=True)]</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(filtered_rows_df_i))</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>data_preprocessor.filterMatches(<span class="st">'message'</span>, <span class="st">"Accept Deal"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>disp<span class="op">=</span> data_preprocessor.getStandardizedDispersion(<span class="st">"Accept Deal"</span>, <span class="va">False</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> <span class="bu">float</span>(disp)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"The dispersion of Accept Deal across all conversatins is: {disp}\n")</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.getConvoMatchesByCase(<span class="st">"Accept Deal"</span>))</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>data_preprocessor.filterMatches(<span class="st">'message'</span>, <span class="st">"Reject Deal"</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>disp<span class="op">=</span> data_preprocessor.getStandardizedDispersion(<span class="st">"Reject Deal"</span>, <span class="va">False</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> <span class="bu">float</span>(disp)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"The dispersion across all conversatins is: {disp}")</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.getConvoMatchesByCase(<span class="st">"Reject Deal"</span>))</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.getConvoMatchesByCase(<span class="st">"Accept Deal"</span> ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The juilland's Dispersion for Accept Deal across all conversations is: 0.9848518493037759

'Accept Deal` Total Number of Case Match Types Across Utterances</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Case Match Type</th>
<th data-quarto-table-cell-role="th">Total Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Exact</td>
<td>1736</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Lower</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>The juilland's Dispersion for Reject Deal across all conversations is: 0.9267553321834224

'Reject Deal` Total Number of Case Match Types Across Utterances</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Case Match Type</th>
<th data-quarto-table-cell-role="th">Total Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Exact</td>
<td>448</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
'Accept Deal` Total Number of Case Match Types Across Utterances</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Case Match Type</th>
<th data-quarto-table-cell-role="th">Total Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Exact</td>
<td>1736</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Lower</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="intersection-of-accept-deal-and-reject-deal" class="level3">
<h3 class="anchored" data-anchor-id="intersection-of-accept-deal-and-reject-deal"><strong>Intersection of “Accept Deal” and “Reject Deal”</strong></h3>
<ul>
<li>In around 187 dialoges, the speakers had multiple attempts to submit agreement outcomes before coming to a resolution.</li>
<li>Accept Deal and Walk Away only had 1 common occurence</li>
<li>277 Reject Deal Disputes, 1736 Accept Deal dialoges, 187 total contained both</li>
</ul>
<p>Follow up questions: - Of the 187, how many disputes had multiple submit agreements? Who submitted more?</p>
<div id="cell-41" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>a_df <span class="op">=</span> data_preprocessor.getMatchedConvoDF(<span class="st">"Accept Deal"</span>, <span class="bu">all</span><span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>r_df <span class="op">=</span> data_preprocessor.getMatchedConvoDF(<span class="st">"Reject Deal"</span>, <span class="bu">all</span><span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>w_df <span class="op">=</span> data_preprocessor.getMatchedConvoDF(<span class="st">"I Walk Away"</span>, <span class="bu">all</span> <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>diff_a_r <span class="op">=</span> data_preprocessor.filterRows(<span class="st">'parsed_dialog'</span>, <span class="st">"Accept Deal"</span>, <span class="st">"Reject Deal"</span>, <span class="va">False</span>, <span class="va">False</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>diff_r_a <span class="op">=</span> data_preprocessor.filterRows(<span class="st">'parsed_dialog'</span>, <span class="st">"Reject Deal"</span>, <span class="st">"Accept Deal"</span>, <span class="va">False</span>, <span class="va">False</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>common_index_a_r <span class="op">=</span> a_df.index.intersection(r_df.index)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>intersection_a_r <span class="op">=</span> a_df.loc[common_index_a_r]</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>common_index_a_w <span class="op">=</span> a_df.index.intersection(w_df.index)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>intersection_a_w <span class="op">=</span> a_df.loc[common_index_a_w]</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>intersection_convos <span class="op">=</span> data_preprocessor.getMatchedConvoDF(<span class="st">"Accept Deal"</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Acccept Deal and Reject Deal Dialog:s"</span>)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>display(intersection_a_r)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Acccept Deal and I Walk Away Dialog:s"</span>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>display(intersection_a_w)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"length of Accept Deal only Dialogs"</span>)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>display(<span class="bu">len</span>(diff_a_r))</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"length of Reject Deal only Dialogs"</span>)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>display(<span class="bu">len</span>(diff_r_a))</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"length of All Accept Deal Dialogs"</span>)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>display(<span class="bu">len</span>(a_df))</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"length of All Reject Deal Dialogs"</span>)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>display(<span class="bu">len</span>(r_df))</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Dialog where Accept Deal and I Walk Away Occur (only one)"</span>)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>display(intersection_a_w[<span class="st">"parsed_dialog"</span>][<span class="dv">2215</span>])</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Example Dialog where Accept Deal and Reject Deal Occur (187 Total)"</span>)</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>display(intersection_a_r[<span class="st">"parsed_dialog"</span>][<span class="dv">18</span>][<span class="op">-</span><span class="dv">1</span>][<span class="st">'message'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Acccept Deal and Reject Deal Dialog:s</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI4u</th>
<th data-quarto-table-cell-role="th">s_PlayAI.1</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>187.0</td>
<td>80.0</td>
<td>0.0</td>
<td>20.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>3.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699668832 Buyer: I need to get a full refund ...</td>
<td>5.0</td>
<td>4.0</td>
<td>[{'timestamp': 1699668832, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">53</td>
<td>NaN</td>
<td>40.0</td>
<td>10.0</td>
<td>30.0</td>
<td>20.0</td>
<td>2.0</td>
<td>5.0</td>
<td>2.0</td>
<td>4.0</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1701299219 Buyer: Hello, I am writing to reque...</td>
<td>1.0</td>
<td>2.0</td>
<td>[{'timestamp': 1701299219, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">67</td>
<td>NaN</td>
<td>70.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1701301304 Buyer: You know the site was advert...</td>
<td>1.0</td>
<td>5.0</td>
<td>[{'timestamp': 1701301304, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">97</td>
<td>187.0</td>
<td>80.0</td>
<td>5.0</td>
<td>5.0</td>
<td>10.0</td>
<td>1.0</td>
<td>5.0</td>
<td>3.0</td>
<td>5.0</td>
<td>5.0</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>NaN</td>
<td>False</td>
<td>1701385289 Buyer: I recieved the wrong item an...</td>
<td>10.0</td>
<td>1.0</td>
<td>[{'timestamp': 1701385289, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">135</td>
<td>187.0</td>
<td>75.0</td>
<td>0.0</td>
<td>25.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>1.0</td>
<td>NaN</td>
<td>False</td>
<td>1701467054 Buyer: I received the incorrect ord...</td>
<td>19.0</td>
<td>4.0</td>
<td>[{'timestamp': 1701467054, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2811</td>
<td>185.0</td>
<td>50.0</td>
<td>5.0</td>
<td>40.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>1.0</td>
<td>Quick text and questions</td>
<td>False</td>
<td>1718700013 Buyer: Hi, the jersey I received wa...</td>
<td>6.0</td>
<td>12.0</td>
<td>[{'timestamp': 1718700013, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2823</td>
<td>185.0</td>
<td>20.0</td>
<td>20.0</td>
<td>60.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>HOW THEY TYPE</td>
<td>False</td>
<td>1718700757 Buyer: I need you to take down the ...</td>
<td>1.0</td>
<td>5.0</td>
<td>[{'timestamp': 1718700757, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2838</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>20.0</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>Just the length of time it took for them to re...</td>
<td>False</td>
<td>1718874191 Buyer: Hi, the Kobe Bryant jersey y...</td>
<td>1.0</td>
<td>17.0</td>
<td>[{'timestamp': 1718874191, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2848</td>
<td>185.0</td>
<td>50.0</td>
<td>10.0</td>
<td>10.0</td>
<td>30.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>sentence structure and emotions</td>
<td>False</td>
<td>1718874101 Buyer: Hello, I have been given the...</td>
<td>7.0</td>
<td>2.0</td>
<td>[{'timestamp': 1718874101, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2858</td>
<td>185.0</td>
<td>70.0</td>
<td>0.0</td>
<td>30.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>They seemed very strong towards their cause, b...</td>
<td>False</td>
<td>1718874274 Buyer: Hi, I have recieved a produc...</td>
<td>2.0</td>
<td>3.0</td>
<td>[{'timestamp': 1718874274, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>187 rows × 53 columns</p>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Acccept Deal and I Walk Away Dialog:s</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI4u</th>
<th data-quarto-table-cell-role="th">s_PlayAI.1</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2215</td>
<td>187.0</td>
<td>75.0</td>
<td>0.0</td>
<td>25.0</td>
<td>0.0</td>
<td>1.0</td>
<td>5.0</td>
<td>5.0</td>
<td>1.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>4.0</td>
<td>NaN</td>
<td>False</td>
<td>1703181808 Buyer: Hello. I would like and exp...</td>
<td>5.0</td>
<td>1.0</td>
<td>[{'timestamp': 1703181808, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>1 rows × 53 columns</p>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>length of Accept Deal only Dialogs</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>1549</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>length of Reject Deal only Dialogs</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>90</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>length of All Accept Deal Dialogs</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>1736</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>length of All Reject Deal Dialogs</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>277</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Dialog where Accept Deal and I Walk Away Occur (only one)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>[{'timestamp': 1703181808,
  'speaker': 'Buyer',
  'message': 'Hello.  I would like and expect a full refund for the jersey.',
  'uttidx': 0,
  'speaker_id': 'Buyer_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703181831,
  'speaker': 'Seller',
  'message': "I don't think that will be possible at this time,",
  'uttidx': 1,
  'speaker_id': 'Seller_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703181855,
  'speaker': 'Buyer',
  'message': 'May I ask why not?',
  'uttidx': 2,
  'speaker_id': 'Buyer_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703181923,
  'speaker': 'Seller',
  'message': 'you posted a false review of my product which caused me to have to address it with other buyers, I would like you to take down the bad review and maybe we can discuss partial refund',
  'uttidx': 3,
  'speaker_id': 'Seller_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703182017,
  'speaker': 'Buyer',
  'message': 'I did not post a false review.  It is an accurate review and I have a screenshot of the original ad to prove it.  If you provide me with a full refund, I will retract my bad review of you, and expect you to do the same.',
  'uttidx': 4,
  'speaker_id': 'Buyer_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703182136,
  'speaker': 'Seller',
  'message': "I would be happy to see the screenshot and determine if you are correct. My website doesn't mention any player jersey by name. That you mistakenly assumed you were buying a particular jersey is on you. I will give a partial refund with removal of false review or full refund with screenshot proving me wrong,",
  'uttidx': 5,
  'speaker_id': 'Seller_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703182243,
  'speaker': 'Buyer',
  'message': "OK I was bluffing on the screenshot :) so I can't prove it.  I will consider a partial repayment (75%) and you withdraw your review of me.",
  'uttidx': 6,
  'speaker_id': 'Buyer_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703182342,
  'speaker': 'Seller',
  'message': 'I will offer 40% refund ( to cover shipping and restocking fees) with removal of your review and upon doing so I will also remove negative review',
  'uttidx': 7,
  'speaker_id': 'Seller_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703182369,
  'speaker': 'Buyer',
  'message': '705',
  'uttidx': 8,
  'speaker_id': 'Buyer_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703182439,
  'speaker': 'Seller',
  'message': '50% final offer',
  'uttidx': 9,
  'speaker_id': 'Seller_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703182491,
  'speaker': 'Buyer',
  'message': '60% for my inconvenience, or I walk away and leave the negative review.  Might even add to it, if so.',
  'uttidx': 10,
  'speaker_id': 'Buyer_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703182596,
  'speaker': 'Seller',
  'message': 'that is your right, I will also have to mention this conversation in my follow up review of your profile :) 50%, remove your review and I remove my review....deal or no deal?',
  'uttidx': 11,
  'speaker_id': 'Seller_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703182616,
  'speaker': 'Buyer',
  'message': 'OK, deal',
  'uttidx': 12,
  'speaker_id': 'Buyer_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703182678,
  'speaker': 'Seller',
  'message': 'I will issue refund immediately :)',
  'uttidx': 13,
  'speaker_id': 'Seller_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703182708,
  'speaker': 'Buyer',
  'message': "Submitted agreement: Buyer gets partial refund, seller retracted their review, buyer retracted their review, seller didn't apologize, and buyer didn't apologize.",
  'uttidx': 14,
  'speaker_id': 'Buyer_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None},
 {'timestamp': 1703182722,
  'speaker': 'Seller',
  'message': 'Accept Deal',
  'uttidx': 15,
  'speaker_id': 'Seller_2215',
  'is_AI': False,
  'row_idx': 2215,
  'match_idx': False,
  'Case Match Type': None}]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Example Dialog where Accept Deal and Reject Deal Occur (187 Total)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>'Accept Deal'</code></pre>
</div>
</div>
</section>
<section id="accept-deal-versus-reject-deal-frequecies-and-relative-position-across-disputes" class="level3">
<h3 class="anchored" data-anchor-id="accept-deal-versus-reject-deal-frequecies-and-relative-position-across-disputes"><strong>“Accept Deal” versus “Reject Deal” Frequecies and Relative Position Across Disputes</strong></h3>
<ul>
<li>Interetestingly, dialogues with “Reject Deal” had participants submit a deal multiple times (higher dispersion of frequencies across conversations) and had continued dialgue after. Pressing “Accept Deal” or “Reject Deal” does not immediately end the chat</li>
<li>None of the chats with multiple deal submissions had an AI as one of the speakers</li>
</ul>
<p>The phrases are mostly evenly distributed across all conversations, with ‘Reject Deal’ being noticably more clustered across conversations <strong>(.74 Julliand’s Dispersion)</strong>. This implies that `Reject Deal’ appears in other places more frequently in the dialog other than when a speaker ends a dispute(value of 1) - With Juliand’s Dispersion: - 0: -&gt; phrases clustered more (less evenly distributed relative to mean frequency) - 1: -&gt; phrases clustered less (more evenly distributed relative to mean frequency)</p>
<p>“Reject Deal” appears more centrally across all disputes, where as “Accept Deal” is most definitely to appead at the end of a dispute. - The mean relative pos of uttterances that contain ‘Walk Away’ for all convos is: 0.6516223038635819 - The mean relative pos of uttterances that contain ‘I Walk Away’ for all convos is: 0.997570375787619</p>
<div id="cell-45" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>d1_disp <span class="op">=</span> data_preprocessor.getStandardizedDispersion(<span class="st">"Accept Deal"</span>, <span class="va">False</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>d2_disp <span class="op">=</span> data_preprocessor.getStandardizedDispersion(<span class="st">"Reject Deal"</span>, <span class="va">False</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>mean_rel_pos_1 <span class="op">=</span> data_preprocessor.getUttStat(<span class="st">"Accept Deal"</span>, <span class="st">"relative_pos"</span>, <span class="st">'mean'</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>mean_rel_pos_2 <span class="op">=</span> data_preprocessor.getUttStat(<span class="st">"Reject Deal"</span>, <span class="st">"relative_pos"</span>, <span class="st">'mean'</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The phrases are mostly evenly distributed across all conversations, with 'Accept Deal' being </span><span class="ch">\n</span><span class="st"> slightly more clustered across conversations. This implies that `Accept Deal` appears in other </span><span class="ch">\n</span><span class="st">  places in the dialog other than when a speaker ends a dispute</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Accept Deal` Distribution by Conversation Match Frequency Values"</span>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.getMatchedConvoDF(<span class="st">"Accept Deal"</span>, <span class="va">True</span>).groupby(<span class="st">"match_freq"</span>).size().reset_index(name<span class="op">=</span><span class="st">"Number of Convos"</span>))</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">'Reject Deal` Distribution by Conversation Match Frequency Values"</span>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.getMatchedConvoDF(<span class="st">"Reject Deal"</span>, <span class="va">True</span>).groupby(<span class="st">"match_freq"</span>).size().reset_index(name<span class="op">=</span><span class="st">"Number of Convos"</span>))</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.getConvoMatchesByCase(<span class="st">"Accept Deal"</span>))</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.getConvoMatchesByCase(<span class="st">"Reject Deal"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The juilland's Dispersion for Accept Deal across all conversations is: 0.9848518493037759
The juilland's Dispersion for Reject Deal across all conversations is: 0.9267553321834224

The 'mean' 'relative_pos' for the phrase `Accept Deal` is: 0.9999136442141623

The 'mean' 'relative_pos' for the phrase `Reject Deal` is: 0.7492541585129935

The phrases are mostly evenly distributed across all conversations, with 'Accept Deal' being 
 slightly more clustered across conversations. This implies that `Accept Deal` appears in other 
  places in the dialog other than when a speaker ends a dispute


 Accept Deal` Distribution by Conversation Match Frequency Values</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">match_freq</th>
<th data-quarto-table-cell-role="th">Number of Convos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>1146</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>1735</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
'Reject Deal` Distribution by Conversation Match Frequency Values</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">match_freq</th>
<th data-quarto-table-cell-role="th">Number of Convos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>2605</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>186</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>55</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>5</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>6</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>8</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>9</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
'Accept Deal` Total Number of Case Match Types Across Utterances</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Case Match Type</th>
<th data-quarto-table-cell-role="th">Total Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Exact</td>
<td>1736</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Lower</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
'Reject Deal` Total Number of Case Match Types Across Utterances</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Case Match Type</th>
<th data-quarto-table-cell-role="th">Total Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Exact</td>
<td>448</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="utterances-with-reject-deal-occurences-3" class="level3">
<h3 class="anchored" data-anchor-id="utterances-with-reject-deal-occurences-3"><strong>Utterances with “Reject Deal” occurences &gt;=3</strong></h3>
<ul>
<li>Check which speaker type is correlated with higher conversation frequencies of “reject deal”</li>
</ul>
<div id="cell-48" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> data_preprocessor.getMatchedConvoDF(<span class="st">"Reject Deal"</span>, <span class="bu">all</span><span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> df[df[<span class="st">"match_freq"</span>] <span class="op">&gt;=</span> <span class="dv">3</span>]</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>display(filtered_df)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span> data_preprocessor.getMatchedUtterancesDF(<span class="st">"Reject Deal"</span>, <span class="bu">all</span> <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>filtered_df_utt <span class="op">=</span> df[df[<span class="st">"row_idx"</span>].isin(filtered_df.index)]</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>display(filtered_df_utt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
<th data-quarto-table-cell-role="th">match_freq</th>
<th data-quarto-table-cell-role="th">convo_len</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">97</td>
<td>187.0</td>
<td>80.0</td>
<td>5.0</td>
<td>5.0</td>
<td>10.0</td>
<td>1.0</td>
<td>5.0</td>
<td>3.0</td>
<td>5.0</td>
<td>5.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1701385289 Buyer: I recieved the wrong item an...</td>
<td>10.0</td>
<td>1.0</td>
<td>[{'timestamp': 1701385289, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>3</td>
<td>27</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">178</td>
<td>187.0</td>
<td>20.0</td>
<td>10.0</td>
<td>35.0</td>
<td>35.0</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1701717020 Buyer: What do you think?\n17017170...</td>
<td>6.0</td>
<td>2.0</td>
<td>[{'timestamp': 1701717020, 'speaker': 'Buyer',...</td>
<td>0.0</td>
<td>1.0</td>
<td>4</td>
<td>17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">216</td>
<td>187.0</td>
<td>50.0</td>
<td>10.0</td>
<td>30.0</td>
<td>10.0</td>
<td>1.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1701800715 Buyer: Hello. This product was not ...</td>
<td>2.0</td>
<td>3.0</td>
<td>[{'timestamp': 1701800715, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
<td>4</td>
<td>19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">258</td>
<td>187.0</td>
<td>100.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>5.0</td>
<td>4.0</td>
<td>1.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1701803959 Buyer: Hi hows it going!\n170180398...</td>
<td>27.0</td>
<td>2.0</td>
<td>[{'timestamp': 1701803959, 'speaker': 'Buyer',...</td>
<td>0.0</td>
<td>1.0</td>
<td>7</td>
<td>28</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">268</td>
<td>187.0</td>
<td>70.0</td>
<td>15.0</td>
<td>10.0</td>
<td>5.0</td>
<td>1.0</td>
<td>2.0</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1701804017 Buyer: My son is upset, I do not ha...</td>
<td>3.0</td>
<td>1.0</td>
<td>[{'timestamp': 1701804017, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
<td>6</td>
<td>23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">367</td>
<td>179.0</td>
<td>60.0</td>
<td>15.0</td>
<td>15.0</td>
<td>10.0</td>
<td>3.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1701880574 Buyer: Hi there\n1701880610 Seller:...</td>
<td>2.0</td>
<td>2.0</td>
<td>[{'timestamp': 1701880574, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>5</td>
<td>31</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">424</td>
<td>122.0</td>
<td>40.0</td>
<td>30.0</td>
<td>20.0</td>
<td>10.0</td>
<td>2.0</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1701901577 Buyer: I have received the wrong je...</td>
<td>5.0</td>
<td>3.0</td>
<td>[{'timestamp': 1701901577, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>5</td>
<td>49</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">441</td>
<td>9.0</td>
<td>70.0</td>
<td>10.0</td>
<td>20.0</td>
<td>0.0</td>
<td>2.0</td>
<td>5.0</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1701902401 Buyer: Hi there, I received my pack...</td>
<td>2.0</td>
<td>2.0</td>
<td>[{'timestamp': 1701902401, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>5</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">448</td>
<td>111.0</td>
<td>40.0</td>
<td>30.0</td>
<td>30.0</td>
<td>0.0</td>
<td>2.0</td>
<td>5.0</td>
<td>4.0</td>
<td>2.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1701906001 Buyer: Hello. I contact you to ask ...</td>
<td>1.0</td>
<td>3.0</td>
<td>[{'timestamp': 1701906001, 'speaker': 'Buyer',...</td>
<td>0.0</td>
<td>1.0</td>
<td>4</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">973</td>
<td>187.0</td>
<td>70.0</td>
<td>7.0</td>
<td>20.0</td>
<td>3.0</td>
<td>1.0</td>
<td>4.0</td>
<td>3.0</td>
<td>5.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702425472 Buyer: Hello, I would like a refund...</td>
<td>2.0</td>
<td>2.0</td>
<td>[{'timestamp': 1702425472, 'speaker': 'Buyer',...</td>
<td>2.0</td>
<td>1.0</td>
<td>3</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1090</td>
<td>187.0</td>
<td>80.0</td>
<td>5.0</td>
<td>10.0</td>
<td>5.0</td>
<td>1.0</td>
<td>5.0</td>
<td>5.0</td>
<td>1.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702498084 Buyer: Hi, I would like to receive ...</td>
<td>6.0</td>
<td>3.0</td>
<td>[{'timestamp': 1702498084, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>3</td>
<td>19</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1131</td>
<td>187.0</td>
<td>95.0</td>
<td>2.0</td>
<td>2.0</td>
<td>1.0</td>
<td>1.0</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702511899 Buyer: I did not receive the item t...</td>
<td>0.0</td>
<td>6.0</td>
<td>[{'timestamp': 1702511899, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>4</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1181</td>
<td>138.0</td>
<td>40.0</td>
<td>20.0</td>
<td>10.0</td>
<td>30.0</td>
<td>3.0</td>
<td>5.0</td>
<td>3.0</td>
<td>3.0</td>
<td>5.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702571107 Buyer: hello, \n1702571114 Seller: ...</td>
<td>2.0</td>
<td>2.0</td>
<td>[{'timestamp': 1702571107, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
<td>3</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1186</td>
<td>163.0</td>
<td>50.0</td>
<td>5.0</td>
<td>25.0</td>
<td>20.0</td>
<td>1.0</td>
<td>4.0</td>
<td>2.0</td>
<td>5.0</td>
<td>2.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702570584 Buyer: Hi, I would like to receive ...</td>
<td>5.0</td>
<td>1.0</td>
<td>[{'timestamp': 1702570584, 'speaker': 'Buyer',...</td>
<td>0.0</td>
<td>1.0</td>
<td>3</td>
<td>16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1195</td>
<td>138.0</td>
<td>20.0</td>
<td>10.0</td>
<td>10.0</td>
<td>60.0</td>
<td>4.0</td>
<td>4.0</td>
<td>5.0</td>
<td>5.0</td>
<td>2.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702570782 Buyer: The item I received was not ...</td>
<td>3.0</td>
<td>7.0</td>
<td>[{'timestamp': 1702570782, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
<td>7</td>
<td>26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1197</td>
<td>138.0</td>
<td>98.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>5.0</td>
<td>1.0</td>
<td>1.0</td>
<td>5.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702571596 Buyer: hello good sir I would like ...</td>
<td>8.0</td>
<td>2.0</td>
<td>[{'timestamp': 1702571596, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>3</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1250</td>
<td>187.0</td>
<td>70.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>2.0</td>
<td>5.0</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702600092 Buyer: The jersey I ordered is for ...</td>
<td>13.0</td>
<td>5.0</td>
<td>[{'timestamp': 1702600092, 'speaker': 'Buyer',...</td>
<td>0.0</td>
<td>1.0</td>
<td>3</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1277</td>
<td>187.0</td>
<td>25.0</td>
<td>25.0</td>
<td>25.0</td>
<td>25.0</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2.0</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702601086 Buyer: First of all, hello. I hope ...</td>
<td>5.0</td>
<td>3.0</td>
<td>[{'timestamp': 1702601086, 'speaker': 'Buyer',...</td>
<td>0.0</td>
<td>1.0</td>
<td>6</td>
<td>25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1352</td>
<td>78.0</td>
<td>20.0</td>
<td>30.0</td>
<td>40.0</td>
<td>10.0</td>
<td>1.0</td>
<td>4.0</td>
<td>2.0</td>
<td>4.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702638163 Buyer: Hello I need a refund for on...</td>
<td>2.0</td>
<td>10.0</td>
<td>[{'timestamp': 1702638163, 'speaker': 'Buyer',...</td>
<td>2.0</td>
<td>1.0</td>
<td>5</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1386</td>
<td>187.0</td>
<td>75.0</td>
<td>10.0</td>
<td>12.0</td>
<td>3.0</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>3.0</td>
<td>5.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702675093 Buyer: hello i want a refund on an ...</td>
<td>3.0</td>
<td>1.0</td>
<td>[{'timestamp': 1702675093, 'speaker': 'Buyer',...</td>
<td>2.0</td>
<td>1.0</td>
<td>3</td>
<td>25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1488</td>
<td>66.0</td>
<td>63.0</td>
<td>7.0</td>
<td>5.0</td>
<td>25.0</td>
<td>4.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>2.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702724020 Buyer: I received the jersey I boug...</td>
<td>6.0</td>
<td>0.0</td>
<td>[{'timestamp': 1702724020, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
<td>3</td>
<td>28</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1533</td>
<td>31.0</td>
<td>70.0</td>
<td>10.0</td>
<td>15.0</td>
<td>5.0</td>
<td>3.0</td>
<td>2.0</td>
<td>4.0</td>
<td>5.0</td>
<td>2.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702756640 Buyer: Hello\n1702756665 Seller: Hi...</td>
<td>5.0</td>
<td>3.0</td>
<td>[{'timestamp': 1702756640, 'speaker': 'Buyer',...</td>
<td>2.0</td>
<td>1.0</td>
<td>9</td>
<td>45</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1650</td>
<td>185.0</td>
<td>88.0</td>
<td>5.0</td>
<td>5.0</td>
<td>2.0</td>
<td>1.0</td>
<td>1.0</td>
<td>5.0</td>
<td>5.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702895958 Buyer: Hi, I am messaging about the...</td>
<td>2.0</td>
<td>0.0</td>
<td>[{'timestamp': 1702895958, 'speaker': 'Buyer',...</td>
<td>2.0</td>
<td>1.0</td>
<td>3</td>
<td>27</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1746</td>
<td>14.0</td>
<td>40.0</td>
<td>20.0</td>
<td>20.0</td>
<td>20.0</td>
<td>5.0</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1702936380 Buyer: I request a full refund as s...</td>
<td>2.0</td>
<td>2.0</td>
<td>[{'timestamp': 1702936380, 'speaker': 'Buyer',...</td>
<td>2.0</td>
<td>1.0</td>
<td>3</td>
<td>19</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1892</td>
<td>185.0</td>
<td>60.0</td>
<td>20.0</td>
<td>20.0</td>
<td>0.0</td>
<td>2.0</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1703068041 Buyer: The wrong item arrived, it i...</td>
<td>1.0</td>
<td>3.0</td>
<td>[{'timestamp': 1703068041, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
<td>3</td>
<td>20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1930</td>
<td>185.0</td>
<td>70.0</td>
<td>10.0</td>
<td>15.0</td>
<td>5.0</td>
<td>1.0</td>
<td>5.0</td>
<td>5.0</td>
<td>4.0</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1703068979 Buyer: hi - your original posting c...</td>
<td>1.0</td>
<td>6.0</td>
<td>[{'timestamp': 1703068979, 'speaker': 'Buyer',...</td>
<td>0.0</td>
<td>1.0</td>
<td>3</td>
<td>34</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1983</td>
<td>31.0</td>
<td>97.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1703093387 Buyer: Hello I ordered a kobe bryan...</td>
<td>0.0</td>
<td>1.0</td>
<td>[{'timestamp': 1703093387, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>3</td>
<td>27</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022</td>
<td>187.0</td>
<td>70.0</td>
<td>0.0</td>
<td>30.0</td>
<td>0.0</td>
<td>3.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1703097067 Buyer: Hello. My item that I purcha...</td>
<td>2.0</td>
<td>0.0</td>
<td>[{'timestamp': 1703097067, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>7</td>
<td>31</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2106</td>
<td>122.0</td>
<td>80.0</td>
<td>10.0</td>
<td>5.0</td>
<td>5.0</td>
<td>1.0</td>
<td>4.0</td>
<td>5.0</td>
<td>3.0</td>
<td>2.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1703154615 Buyer: Hi, I would receive my refun...</td>
<td>2.0</td>
<td>2.0</td>
<td>[{'timestamp': 1703154615, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>5</td>
<td>31</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2205</td>
<td>31.0</td>
<td>90.0</td>
<td>5.0</td>
<td>5.0</td>
<td>0.0</td>
<td>2.0</td>
<td>2.0</td>
<td>2.0</td>
<td>4.0</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1703179950 Buyer: I want a refund please. I di...</td>
<td>0.0</td>
<td>2.0</td>
<td>[{'timestamp': 1703179950, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
<td>3</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2236</td>
<td>31.0</td>
<td>40.0</td>
<td>20.0</td>
<td>10.0</td>
<td>30.0</td>
<td>2.0</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1703183385 Buyer: Hi, I'd like to request a re...</td>
<td>2.0</td>
<td>1.0</td>
<td>[{'timestamp': 1703183385, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>8</td>
<td>28</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2354</td>
<td>161.0</td>
<td>70.0</td>
<td>15.0</td>
<td>10.0</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>2.0</td>
<td>5.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1704892826 Buyer: i want my full refund \n1704...</td>
<td>5.0</td>
<td>5.0</td>
<td>[{'timestamp': 1704892826, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
<td>4</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2463</td>
<td>161.0</td>
<td>80.0</td>
<td>10.0</td>
<td>5.0</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1705497216 Buyer: Full refund so i can purchas...</td>
<td>9.0</td>
<td>4.0</td>
<td>[{'timestamp': 1705497216, 'speaker': 'Buyer',...</td>
<td>0.0</td>
<td>1.0</td>
<td>3</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2645</td>
<td>187.0</td>
<td>100.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>It could be either, I thought the conversation...</td>
<td>False</td>
<td>1717706575 Buyer: Hi\n1717706581 Seller: Hello...</td>
<td>2.0</td>
<td>0.0</td>
<td>[{'timestamp': 1717706575, 'speaker': 'Buyer',...</td>
<td>0.0</td>
<td>1.0</td>
<td>3</td>
<td>32</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2818</td>
<td>161.0</td>
<td>75.0</td>
<td>10.0</td>
<td>5.0</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>They came up with a blatent lie about a nephew...</td>
<td>False</td>
<td>1718700114 Buyer: I ordered the kobe byrant je...</td>
<td>6.0</td>
<td>3.0</td>
<td>[{'timestamp': 1718700114, 'speaker': 'Buyer',...</td>
<td>2.0</td>
<td>1.0</td>
<td>3</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2848</td>
<td>185.0</td>
<td>50.0</td>
<td>10.0</td>
<td>10.0</td>
<td>30.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>sentence structure and emotions</td>
<td>False</td>
<td>1718874101 Buyer: Hello, I have been given the...</td>
<td>7.0</td>
<td>2.0</td>
<td>[{'timestamp': 1718874101, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>3</td>
<td>21</td>
</tr>
</tbody>
</table>

<p>36 rows × 55 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">speaker</th>
<th data-quarto-table-cell-role="th">message</th>
<th data-quarto-table-cell-role="th">uttidx</th>
<th data-quarto-table-cell-role="th">speaker_id</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">row_idx</th>
<th data-quarto-table-cell-role="th">match_idx</th>
<th data-quarto-table-cell-role="th">Case Match Type</th>
<th data-quarto-table-cell-role="th">convo_len</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1401</td>
<td>1701385722</td>
<td>Buyer</td>
<td>Reject Deal</td>
<td>20</td>
<td>Buyer_97</td>
<td>False</td>
<td>97</td>
<td>True</td>
<td>Exact</td>
<td>27</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1403</td>
<td>1701385741</td>
<td>Seller</td>
<td>Reject Deal</td>
<td>22</td>
<td>Seller_97</td>
<td>False</td>
<td>97</td>
<td>True</td>
<td>Exact</td>
<td>27</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1405</td>
<td>1701385760</td>
<td>Buyer</td>
<td>Reject Deal</td>
<td>24</td>
<td>Buyer_97</td>
<td>False</td>
<td>97</td>
<td>True</td>
<td>Exact</td>
<td>27</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2488</td>
<td>1701717589</td>
<td>Seller</td>
<td>Reject Deal</td>
<td>9</td>
<td>Seller_178</td>
<td>False</td>
<td>178</td>
<td>True</td>
<td>Exact</td>
<td>17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2490</td>
<td>1701717628</td>
<td>Buyer</td>
<td>Reject Deal</td>
<td>11</td>
<td>Buyer_178</td>
<td>False</td>
<td>178</td>
<td>True</td>
<td>Exact</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38987</td>
<td>1718701117</td>
<td>Seller</td>
<td>Reject Deal</td>
<td>16</td>
<td>Seller_2818</td>
<td>False</td>
<td>2818</td>
<td>True</td>
<td>Exact</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">38989</td>
<td>1718701167</td>
<td>Buyer</td>
<td>Reject Deal</td>
<td>18</td>
<td>Buyer_2818</td>
<td>False</td>
<td>2818</td>
<td>True</td>
<td>Exact</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39389</td>
<td>1718875197</td>
<td>Buyer</td>
<td>Reject Deal</td>
<td>10</td>
<td>Buyer_2848</td>
<td>False</td>
<td>2848</td>
<td>True</td>
<td>Exact</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39391</td>
<td>1718875229</td>
<td>Seller</td>
<td>Reject Deal</td>
<td>12</td>
<td>Seller_2848</td>
<td>False</td>
<td>2848</td>
<td>True</td>
<td>Exact</td>
<td>21</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39393</td>
<td>1718875334</td>
<td>Buyer</td>
<td>Reject Deal</td>
<td>14</td>
<td>Buyer_2848</td>
<td>False</td>
<td>2848</td>
<td>True</td>
<td>Exact</td>
<td>21</td>
</tr>
</tbody>
</table>

<p>152 rows × 10 columns</p>
</div>
</div>
</div>
</section>
<section id="accept-dealreject-deal-utterance-counts-by-speaker-type" class="level3">
<h3 class="anchored" data-anchor-id="accept-dealreject-deal-utterance-counts-by-speaker-type"><strong>“Accept Deal/Reject Deal” Utterance Counts by Speaker Type</strong></h3>
<ul>
<li>Seller more likely to Accept Deal</li>
<li>Buyer more likely to Reject Deal</li>
</ul>
<div id="cell-51" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.groupbyMatchUttStat(<span class="st">'Accept Deal'</span>, <span class="st">'speaker'</span>, [<span class="st">'row_idx'</span>], [<span class="st">'count'</span>]))</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.groupbyMatchUttStat(<span class="st">'Reject Deal'</span>, <span class="st">'speaker'</span>, [<span class="st">'row_idx'</span>], [<span class="st">'count'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key Value: Accept Deal, Grouped by: speaker, Aggregated columns: ['row_idx'], Aggregations: {'row_idx': 'count'}</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count_row_idx</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">speaker</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Buyer</td>
<td>818</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Seller</td>
<td>919</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Key Value: Reject Deal, Grouped by: speaker, Aggregated columns: ['row_idx'], Aggregations: {'row_idx': 'count'}</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count_row_idx</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">speaker</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Buyer</td>
<td>236</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Seller</td>
<td>212</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="relative-mean-position-of-accept-dealreject-deal-across-all-conversations-by-speaker" class="level3">
<h3 class="anchored" data-anchor-id="relative-mean-position-of-accept-dealreject-deal-across-all-conversations-by-speaker"><strong>Relative Mean Position of “Accept Deal/Reject Deal” across all Conversations by Speaker</strong></h3>
<ul>
<li>No Ai agents could chose to subit or accept the deal-&gt; humna had to be the one to end the dispute</li>
<li>potential dataset imbalance?</li>
</ul>
<div id="cell-54" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.groupbyMatchUttStat(<span class="st">'Accept Deal'</span>, <span class="st">'speaker'</span>, [<span class="st">'relative_pos'</span>, <span class="st">'is_AI'</span>], [<span class="st">'mean'</span>, <span class="st">'mean'</span>]))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.groupbyMatchUttStat(<span class="st">'Reject Deal'</span>, <span class="st">'speaker'</span>, [<span class="st">'relative_pos'</span>, <span class="st">'is_AI'</span>], [<span class="st">'mean'</span>, <span class="st">'mean'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key Value: Accept Deal, Grouped by: speaker, Aggregated columns: ['relative_pos', 'is_AI'], Aggregations: {'relative_pos': 'mean', 'is_AI': 'mean'}</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean_relative_pos</th>
<th data-quarto-table-cell-role="th">mean_is_AI</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">speaker</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Buyer</td>
<td>1.000000</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Seller</td>
<td>0.999837</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Key Value: Reject Deal, Grouped by: speaker, Aggregated columns: ['relative_pos', 'is_AI'], Aggregations: {'relative_pos': 'mean', 'is_AI': 'mean'}</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean_relative_pos</th>
<th data-quarto-table-cell-role="th">mean_is_AI</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">speaker</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Buyer</td>
<td>0.750741</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Seller</td>
<td>0.747599</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="submit-agreement-analysis" class="level1">
<h1>Submit Agreement Analysis</h1>
<ul>
<li>I think submit agreemnt is LAST only when AI happens
<ul>
<li>646 dialogues where this is the case</li>
</ul></li>
</ul>
<section id="number-of-chats-that-have-submit-agreement" class="level3">
<h3 class="anchored" data-anchor-id="number-of-chats-that-have-submit-agreement"><strong>Number of chats that have submit agreement</strong></h3>
<div id="cell-57" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>test_submit <span class="op">=</span> DataPreprocesser(filepath)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>test_submit.filterMatches(<span class="st">"message"</span>, <span class="st">"Submitted agreement"</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> test_submit.getMatchedConvoDF(<span class="st">"Submitted agreement"</span>, <span class="bu">all</span><span class="op">=</span><span class="va">False</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>display(df)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>data_preprocessor.filterMatches(<span class="st">"message"</span>, <span class="st">"Submitted agreement"</span>)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>test_submit.getMatchedUtterancesDF(<span class="st">"Submitted agreement"</span>)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>test_submit_last <span class="op">=</span> test_submit.getDataframe()[test_submit.getDataframe()[<span class="st">"parsed_dialog"</span>].<span class="bu">apply</span>(test_submit.is_submit_agreement)]</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>display(test_submit_last)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2882</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI4u</th>
<th data-quarto-table-cell-role="th">s_PlayAI.1</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>187.0</td>
<td>40.0</td>
<td>10.0</td>
<td>31.0</td>
<td>19.0</td>
<td>3.0</td>
<td>1.0</td>
<td>2.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699388451 Buyer: Hi there! I believe I receiv...</td>
<td>3.0</td>
<td>1.0</td>
<td>[{'timestamp': 1699388451, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>187.0</td>
<td>40.0</td>
<td>10.0</td>
<td>30.0</td>
<td>20.0</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>NaN</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Buyer: Your response is utterly unacceptab...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Buyer', 'mes...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Buyer: Your response is utterly unacceptab...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Buyer', 'mes...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Buyer: Your response is utterly unacceptab...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Buyer', 'mes...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2877</td>
<td>161.0</td>
<td>50.0</td>
<td>10.0</td>
<td>20.0</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2878</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>30.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2879</td>
<td>185.0</td>
<td>50.0</td>
<td>10.0</td>
<td>30.0</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2880</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>25.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>It souunded too good to be true yet so human a...</td>
<td>False</td>
<td>1718878682 Buyer: Hi there, thank you for send...</td>
<td>3.0</td>
<td>4.0</td>
<td>[{'timestamp': 1718878682, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2881</td>
<td>185.0</td>
<td>40.0</td>
<td>20.0</td>
<td>30.0</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>2537 rows × 53 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI4u</th>
<th data-quarto-table-cell-role="th">s_PlayAI.1</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>187.0</td>
<td>40.0</td>
<td>10.0</td>
<td>30.0</td>
<td>20.0</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>NaN</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Buyer: Your response is utterly unacceptab...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Buyer', 'mes...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Buyer: Your response is utterly unacceptab...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Buyer', 'mes...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Buyer: Your response is utterly unacceptab...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Buyer', 'mes...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>187.0</td>
<td>50.0</td>
<td>50.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>5.0</td>
<td>4.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2875</td>
<td>161.0</td>
<td>20.0</td>
<td>30.0</td>
<td>30.0</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2876</td>
<td>185.0</td>
<td>50.0</td>
<td>15.0</td>
<td>25.0</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2877</td>
<td>161.0</td>
<td>50.0</td>
<td>10.0</td>
<td>20.0</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2878</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>30.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2881</td>
<td>185.0</td>
<td>40.0</td>
<td>20.0</td>
<td>30.0</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>646 rows × 53 columns</p>
</div>
</div>
</div>
</section>
<section id="frequencies-and-relative-position-across-disputes" class="level3">
<h3 class="anchored" data-anchor-id="frequencies-and-relative-position-across-disputes"><strong>Frequencies and Relative Position Across Disputes</strong></h3>
<div id="cell-59" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Includes exact matches for "Submitted agreement"</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>data_preprocessor.filterMatches(<span class="st">"message"</span>, <span class="st">"Submitted agreement"</span>, case_in<span class="op">=</span><span class="va">False</span>, case_ex<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Dispersion stats</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>sa_disp <span class="op">=</span> data_preprocessor.getStandardizedDispersion(<span class="st">"Submitted agreement"</span>, <span class="va">False</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean relative position</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>mean_rel_pos_sa <span class="op">=</span> data_preprocessor.getUttStat(<span class="st">"Submitted agreement"</span>, <span class="st">"relative_pos"</span>, <span class="st">"mean"</span>)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print interpretation</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The phrase 'Submitted agreement' appears to occur consistently near key conversation points. </span><span class="ch">\n</span><span class="st">This may indicate formal resolution moments during disputes or agreements.</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">'Submitted agreement' Distribution by Conversation Match Frequency Values"</span>)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.text_matches_new[<span class="st">"Submitted agreement"</span>][<span class="dv">1</span>].groupby(<span class="st">"match_freq"</span>).size().reset_index(name<span class="op">=</span><span class="st">"Number of Convos"</span>))</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">'Submitted agreement' Distribution by Conversation Match Frequency Occurrences"</span>)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.getConvoMatchesByCase(<span class="st">"Submitted agreement"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The juilland's Dispersion for Submitted agreement across all conversations is: 0.9873675621341327

The 'mean' 'relative_pos' for the phrase `Submitted agreement` is: 0.8977921586293852

The phrase 'Submitted agreement' appears to occur consistently near key conversation points. 
This may indicate formal resolution moments during disputes or agreements.


'Submitted agreement' Distribution by Conversation Match Frequency Values</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">match_freq</th>
<th data-quarto-table-cell-role="th">Number of Convos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>345</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2284</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>176</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>45</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>5</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>6</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>7</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>8</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>9</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
'Submitted agreement' Distribution by Conversation Match Frequency Occurrences

'Submitted agreement` Total Number of Case Match Types Across Utterances</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Case Match Type</th>
<th data-quarto-table-cell-role="th">Total Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Exact</td>
<td>2940</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Lower</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="utterance-counts-by-speaker-type" class="level3">
<h3 class="anchored" data-anchor-id="utterance-counts-by-speaker-type"><strong>Utterance Counts by Speaker Type</strong></h3>
<div id="cell-61" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.groupbyMatchUttStat(<span class="st">'Submitted agreement'</span>, <span class="st">'speaker'</span>, [<span class="st">'row_idx'</span>], [<span class="st">'count'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key Value: Submitted agreement, Grouped by: speaker, Aggregated columns: ['row_idx'], Aggregations: {'row_idx': 'count'}</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count_row_idx</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">speaker</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Buyer</td>
<td>1578</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Seller</td>
<td>1363</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="dispute-outcome-and-frequency-of-submitted-agreement" class="level3">
<h3 class="anchored" data-anchor-id="dispute-outcome-and-frequency-of-submitted-agreement"><strong>Dispute Outcome and Frequency of Submitted Agreement</strong></h3>
<div id="cell-63" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Get the two dataframes</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>out_df <span class="op">=</span> data_preprocessor.getMatchedConvoDF(<span class="st">"Submitted agreement"</span>, <span class="va">True</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>match_df <span class="op">=</span> data_preprocessor.text_matches_new[<span class="st">"Submitted agreement"</span>][<span class="dv">1</span>]</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Add 'dispute_outcome' from out_df to match_df based on index</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>match_df <span class="op">=</span> match_df.copy()</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>match_df[<span class="st">"dispute_outcome"</span>] <span class="op">=</span> out_df[<span class="st">"dispute_outcome"</span>]</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Drop rows where dispute_outcome is missing</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>match_df_clean <span class="op">=</span> match_df.dropna(subset<span class="op">=</span>[<span class="st">"dispute_outcome"</span>])</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Convert to int for clarity</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>match_df_clean[<span class="st">"dispute_outcome"</span>] <span class="op">=</span> match_df_clean[<span class="st">"dispute_outcome"</span>].astype(<span class="bu">int</span>)</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Group by match_freq and count each outcome</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>outcome_counts <span class="op">=</span> (</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>    match_df_clean.groupby(<span class="st">"match_freq"</span>)[<span class="st">"dispute_outcome"</span>]</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    .value_counts()</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>    .unstack(fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="dv">0</span>: <span class="st">"Impasse"</span>, <span class="dv">1</span>: <span class="st">"Success"</span>})</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for cleaner labels</span></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>outcome_counts_renamed <span class="op">=</span> outcome_counts.rename(columns<span class="op">=</span>{</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dispute Succeeded"</span>: <span class="st">"Success"</span>,</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dispute Failed"</span>: <span class="st">"Impasse"</span></span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>plt.bar(outcome_counts_renamed[<span class="st">"match_freq"</span>], outcome_counts_renamed[<span class="st">"Success"</span>], label<span class="op">=</span><span class="st">"Success"</span>, color<span class="op">=</span><span class="st">"green"</span>)</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>plt.bar(</span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>    outcome_counts_renamed[<span class="st">"match_freq"</span>],</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>    outcome_counts_renamed[<span class="st">"Impasse"</span>],</span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a>    bottom<span class="op">=</span>outcome_counts_renamed[<span class="st">"Success"</span>],</span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"Impasse"</span>,</span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"red"</span></span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Labels &amp; styling</span></span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Number of 'Submitted agreement' Mentions (match_freq)"</span>)</span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Number of Conversations"</span>)</span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Dispute Outcome by Frequency of 'Submitted agreement'"</span>)</span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a>plt.xticks(outcome_counts_renamed[<span class="st">"match_freq"</span>])</span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a>plt.grid(axis<span class="op">=</span><span class="st">"y"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/3m/c14l8zg55jqdgkz6b8lkr6z40000gn/T/ipykernel_66790/352638023.py:13: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  match_df_clean["dispute_outcome"] = match_df_clean["dispute_outcome"].astype(int)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="data_preprocessing_files/figure-html/cell-23-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="final-valid-success-and-impasse-disputes" class="level1">
<h1>Final Valid Success and Impasse Disputes</h1>
<section id="getting-final-dataframes" class="level3">
<h3 class="anchored" data-anchor-id="getting-final-dataframes"><strong>Getting Final DataFrames</strong></h3>
<p>Made using “I Walk Away” Matched Conversations and ” Accept Deal” in last line of Dispute</p>
<div id="cell-66" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">'''For all dialoges, make sure that the last line is "Accept Deal or Walk away'''</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>final_success_df <span class="op">=</span> data_preprocessor.getMatchedConvoDF(<span class="st">"Accept Deal"</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>final_success_df  <span class="op">=</span> final_success_df[final_success_df[<span class="st">"parsed_dialog"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> lst: lst[<span class="op">-</span><span class="dv">1</span>][<span class="st">'message'</span>] <span class="op">==</span> <span class="st">"Accept Deal"</span>)]</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>display(final_success_df)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>final_reject_df <span class="op">=</span> data_preprocessor.getMatchedConvoDF(<span class="st">"I Walk Away"</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>final_reject_df  <span class="op">=</span> final_reject_df[final_reject_df[<span class="st">"parsed_dialog"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> lst: <span class="st">"I Walk Away"</span> <span class="kw">in</span> lst[<span class="op">-</span><span class="dv">1</span>][<span class="st">'message'</span>])]</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>display(final_reject_df)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>last_messages_reject <span class="op">=</span> pd.DataFrame(final_reject_df[<span class="st">"parsed_dialog"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> lst: lst[<span class="op">-</span><span class="dv">1</span>][<span class="st">'message'</span>] <span class="cf">if</span> <span class="bu">isinstance</span>(lst, <span class="bu">list</span>) <span class="kw">and</span> <span class="bu">len</span>(lst) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="va">None</span>))</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>display(last_messages_reject)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>last_messages_accept <span class="op">=</span> pd.DataFrame(final_success_df[<span class="st">"parsed_dialog"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> lst: lst[<span class="op">-</span><span class="dv">1</span>][<span class="st">'message'</span>] <span class="cf">if</span> <span class="bu">isinstance</span>(lst, <span class="bu">list</span>) <span class="kw">and</span> <span class="bu">len</span>(lst) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="va">None</span>))</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>display(last_messages_accept)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI4u</th>
<th data-quarto-table-cell-role="th">s_PlayAI.1</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>187.0</td>
<td>40.0</td>
<td>10.0</td>
<td>31.0</td>
<td>19.0</td>
<td>3.0</td>
<td>1.0</td>
<td>2.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699388451 Buyer: Hi there! I believe I receiv...</td>
<td>3.0</td>
<td>1.0</td>
<td>[{'timestamp': 1699388451, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>187.0</td>
<td>50.0</td>
<td>8.0</td>
<td>30.0</td>
<td>12.0</td>
<td>2.0</td>
<td>5.0</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699389969 Buyer: Hello. I need you to make th...</td>
<td>2.0</td>
<td>6.0</td>
<td>[{'timestamp': 1699389969, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>187.0</td>
<td>80.0</td>
<td>0.0</td>
<td>20.0</td>
<td>0.0</td>
<td>1.0</td>
<td>3.0</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699392080 Buyer: I would prefer a refund as t...</td>
<td>2.0</td>
<td>5.0</td>
<td>[{'timestamp': 1699392080, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>187.0</td>
<td>40.0</td>
<td>30.0</td>
<td>20.0</td>
<td>10.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699392404 Buyer: I didn't receive the correct...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 1699392404, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>187.0</td>
<td>90.0</td>
<td>5.0</td>
<td>5.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>2.0</td>
<td>NaN</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699393461 Buyer: Hello! I need you to refund ...</td>
<td>3.0</td>
<td>0.0</td>
<td>[{'timestamp': 1699393461, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2866</td>
<td>161.0</td>
<td>50.0</td>
<td>10.0</td>
<td>15.0</td>
<td>25.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>The conversation was emotions and had typing e...</td>
<td>False</td>
<td>1718874750 Buyer: My product arrived broken , ...</td>
<td>1.0</td>
<td>2.0</td>
<td>[{'timestamp': 1718874750, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2869</td>
<td>161.0</td>
<td>15.0</td>
<td>20.0</td>
<td>25.0</td>
<td>40.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>because he responded genuinely</td>
<td>False</td>
<td>1718875387 Buyer: Hello i requesting for a par...</td>
<td>2.0</td>
<td>6.0</td>
<td>[{'timestamp': 1718875387, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2871</td>
<td>185.0</td>
<td>75.0</td>
<td>0.0</td>
<td>25.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1718875699 Buyer: I would like a refund, the b...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 1718875699, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2872</td>
<td>161.0</td>
<td>35.0</td>
<td>20.0</td>
<td>30.0</td>
<td>15.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>sentences were short and minimal information g...</td>
<td>False</td>
<td>1718876074 Buyer: Hey, I received my order and...</td>
<td>4.0</td>
<td>3.0</td>
<td>[{'timestamp': 1718876074, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2880</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>25.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>It souunded too good to be true yet so human a...</td>
<td>False</td>
<td>1718878682 Buyer: Hi there, thank you for send...</td>
<td>3.0</td>
<td>4.0</td>
<td>[{'timestamp': 1718878682, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>1736 rows × 53 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI4u</th>
<th data-quarto-table-cell-role="th">s_PlayAI.1</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>187.0</td>
<td>80.0</td>
<td>12.0</td>
<td>5.0</td>
<td>3.0</td>
<td>1.0</td>
<td>4.0</td>
<td>5.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>NaN</td>
<td>60.0</td>
<td>10.0</td>
<td>20.0</td>
<td>10.0</td>
<td>4.0</td>
<td>5.0</td>
<td>5.0</td>
<td>5.0</td>
<td>2.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">46</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Buyer: Your response is utterly unacceptab...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Buyer', 'mes...</td>
<td>2.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>4.0</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Buyer: Your response is utterly unacceptab...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Buyer', 'mes...</td>
<td>2.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58</td>
<td>NaN</td>
<td>75.0</td>
<td>0.0</td>
<td>25.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1.0</td>
<td>5.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1701300334 Buyer: I ordered this for a sick ch...</td>
<td>7.0</td>
<td>2.0</td>
<td>[{'timestamp': 1701300334, 'speaker': 'Buyer',...</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2844</td>
<td>161.0</td>
<td>70.0</td>
<td>0.0</td>
<td>10.0</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1718875250 Seller: Hi I am sorry to hear that ...</td>
<td>5.0</td>
<td>2.0</td>
<td>[{'timestamp': 1718875250, 'speaker': 'Seller'...</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2853</td>
<td>161.0</td>
<td>60.0</td>
<td>0.0</td>
<td>20.0</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>1.0</td>
<td>the reposnse lacked emotions</td>
<td>False</td>
<td>1718874473 Buyer: Good day seller. I think you...</td>
<td>5.0</td>
<td>12.0</td>
<td>[{'timestamp': 1718874473, 'speaker': 'Buyer',...</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2859</td>
<td>185.0</td>
<td>40.0</td>
<td>20.0</td>
<td>30.0</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>Spelling was always on par and just felt robot...</td>
<td>False</td>
<td>1718874176 Buyer: hey\n1718874183 Seller: Hi T...</td>
<td>5.0</td>
<td>3.0</td>
<td>[{'timestamp': 1718874176, 'speaker': 'Buyer',...</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2861</td>
<td>161.0</td>
<td>50.0</td>
<td>30.0</td>
<td>0.0</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1718874729 Buyer: I purchased a Kobe Bryant sh...</td>
<td>6.0</td>
<td>2.0</td>
<td>[{'timestamp': 1718874729, 'speaker': 'Buyer',...</td>
<td>2.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2870</td>
<td>137.0</td>
<td>90.0</td>
<td>0.0</td>
<td>10.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>how he responded</td>
<td>False</td>
<td>1718875522 Buyer: Hello, I would like to recei...</td>
<td>0.0</td>
<td>1.0</td>
<td>[{'timestamp': 1718875522, 'speaker': 'Buyer',...</td>
<td>2.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>464 rows × 53 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>I Walk Away.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>I Walk Away.</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">46</td>
<td>I Walk Away.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50</td>
<td>I Walk Away.</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">58</td>
<td>I Walk Away.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2844</td>
<td>I Walk Away.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2853</td>
<td>I Walk Away.</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2859</td>
<td>I Walk Away.</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2861</td>
<td>I Walk Away.</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2870</td>
<td>I Walk Away.</td>
</tr>
</tbody>
</table>

<p>464 rows × 1 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Accept Deal</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>Accept Deal</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>Accept Deal</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>Accept Deal</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Accept Deal</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2866</td>
<td>Accept Deal</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2869</td>
<td>Accept Deal</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2871</td>
<td>Accept Deal</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2872</td>
<td>Accept Deal</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2880</td>
<td>Accept Deal</td>
</tr>
</tbody>
</table>

<p>1736 rows × 1 columns</p>
</div>
</div>
</div>
<div id="cell-67" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"number of AI dialogues for Accepted Deals"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>display(data_preprocessor.groupbyMatchUttStat(<span class="st">'I Walk Away'</span>, <span class="st">'speaker'</span>, [<span class="st">'relative_pos'</span>, <span class="st">'is_AI'</span>], [<span class="st">'mean'</span>, <span class="st">'mean'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>number of AI dialogues for Accepted Deals
Key Value: I Walk Away, Grouped by: speaker, Aggregated columns: ['relative_pos', 'is_AI'], Aggregations: {'relative_pos': 'mean', 'is_AI': 'mean'}</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean_relative_pos</th>
<th data-quarto-table-cell-role="th">mean_is_AI</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">speaker</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Buyer</td>
<td>0.99743</td>
<td>0.013216</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Seller</td>
<td>0.99770</td>
<td>0.004065</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="identifying-if-buyer-or-seller-ended-the-dispute" class="level3">
<h3 class="anchored" data-anchor-id="identifying-if-buyer-or-seller-ended-the-dispute"><strong>Identifying if buyer or seller ended the dispute</strong></h3>
<div id="cell-69" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply mapping to final_success_df_counts</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>flag_speaker_map <span class="op">=</span> {</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">"Buyer - I Walk Away"</span>,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">"Buyer - Accept Deal"</span>,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">"Seller - I Walk Away"</span>,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">"Seller - Accept Deal"</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>flag_speaker_counts_accept <span class="op">=</span> final_success_df[<span class="st">"flag_speaker"</span>].value_counts()</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>flag_speaker_counts_reject <span class="op">=</span> final_reject_df[<span class="st">"flag_speaker"</span>].value_counts()</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>flag_speaker_counts_accept.index <span class="op">=</span> flag_speaker_counts_accept.index.<span class="bu">map</span>(flag_speaker_map)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(flag_speaker_counts_accept)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply mapping to final_reject_df_counts</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>flag_speaker_counts_reject.index <span class="op">=</span> flag_speaker_counts_reject.index.<span class="bu">map</span>(flag_speaker_map)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>display(flag_speaker_counts_reject)</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total counts per outcome</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>total_accept_deals <span class="op">=</span> flag_speaker_counts_accept.<span class="bu">sum</span>()  <span class="co"># 918 + 818</span></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>total_rejects <span class="op">=</span> flag_speaker_counts_reject.<span class="bu">sum</span>()  <span class="co"># 240 + 224</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to percentage within each category</span></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>accept_deals_percent <span class="op">=</span> (flag_speaker_counts_accept <span class="op">/</span> total_accept_deals) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>reject_deals_percent <span class="op">=</span> (flag_speaker_counts_reject <span class="op">/</span> total_rejects) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine both into a single DataFrame</span></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>flag_speaker_percentage <span class="op">=</span> pd.DataFrame({</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Accept Deal"</span>: accept_deals_percent,</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I Walk Away"</span>: reject_deals_percent</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>}).fillna(<span class="dv">0</span>)  <span class="co"># Fill NaN values with 0</span></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the percentage data</span></span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>flag_speaker_percentage.plot(kind<span class="op">=</span><span class="st">"bar"</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>), color<span class="op">=</span>[<span class="st">"green"</span>, <span class="st">"red"</span>])</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels and title</span></span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Speaker &amp; Outcome"</span>)</span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Percentage (%)"</span>)</span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Percentage Distribution of 'Accept Deal' &amp; 'I Walk Away'"</span>)</span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">"Outcome"</span>)</span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)  <span class="co"># Rotate labels for readability</span></span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">100</span>)  <span class="co"># Ensure y-axis is between 0 and 100%</span></span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>flag_speaker
Seller - Accept Deal    918
Buyer - Accept Deal     818
Name: count, dtype: int64</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>flag_speaker
Seller - I Walk Away    240
Buyer - I Walk Away     224
Name: count, dtype: int64</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="data_preprocessing_files/figure-html/cell-26-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="total-number-of-acceptedrejected-deals" class="level3">
<h3 class="anchored" data-anchor-id="total-number-of-acceptedrejected-deals"><strong>Total number of Accepted/Rejected Deals</strong></h3>
<div id="cell-71" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total counts for accepted and rejected deals</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>total_accept_deals <span class="op">=</span> flag_speaker_counts_accept.<span class="bu">sum</span>()  <span class="co"># 918 + 818</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>total_rejects <span class="op">=</span> flag_speaker_counts_reject.<span class="bu">sum</span>()  <span class="co"># 240 + 224</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>total_deals <span class="op">=</span> total_accept_deals <span class="op">+</span> total_rejects  <span class="co"># Total transactions</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute percentage of total deals</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>deal_outcomes_percentage <span class="op">=</span> pd.Series({</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Accept Deal"</span>: (total_accept_deals <span class="op">/</span> total_deals) <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I Walk Away"</span>: (total_rejects <span class="op">/</span> total_deals) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>deal_outcomes_percentage.plot(kind<span class="op">=</span><span class="st">"bar"</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>), color<span class="op">=</span>[<span class="st">"green"</span>, <span class="st">"red"</span>])</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Labels &amp; title</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Outcome"</span>)</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Percentage of Total Deals (%)"</span>)</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Percentage Distribution of Accepted vs. Rejected Deals"</span>)</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">100</span>)  <span class="co"># Ensure percentage scale</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)  <span class="co"># Keep labels horizontal for readability</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>plt.grid(axis<span class="op">=</span><span class="st">"y"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)  <span class="co"># Add horizontal grid lines for clarity</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Show plot</span></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="data_preprocessing_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="corrected-labels-from-alldyads_labels.csv-file" class="level1">
<h1>Corrected Labels from alldyads_labels.csv file</h1>
<div id="cell-73" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> pd.read_csv(<span class="st">'/Users/mishkin/Desktop/Research/Convo_Kit/ConvoKit_Disputes/data/alldyads_labels.csv'</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>main_df <span class="op">=</span> pd.read_csv(<span class="st">'/Users/mishkin/Desktop/Research/Convo_Kit/ConvoKit_Disputes/data/alldyads.csv'</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>main_df <span class="op">=</span> main_df.dropna(subset<span class="op">=</span>[<span class="st">"formattedChat"</span>]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>main_df <span class="op">=</span> main_df.merge(</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    labels[[<span class="st">"formattedChat"</span>, <span class="st">"b_final_result"</span>]],</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span><span class="st">"formattedChat"</span>,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">"inner"</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>main_df <span class="op">=</span> main_df.dropna(subset<span class="op">=</span>[<span class="st">"b_final_result"</span>])</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>main_df <span class="op">=</span> main_df[main_df[<span class="st">"is_AI"</span>] <span class="op">!=</span> <span class="va">True</span>]</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the "dispute_outcome" column: 1 if value is "Z", else 0</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="co">#"Z" is "impasse" -&gt; 1 </span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>main_df[<span class="st">"dispute_outcome"</span>] <span class="op">=</span> main_df[<span class="st">"b_final_result"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">1</span> <span class="cf">if</span> x <span class="op">==</span> <span class="st">"Z"</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>display(main_df)</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> main_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_Use emotions</th>
<th data-quarto-table-cell-role="th">s_AI4u</th>
<th data-quarto-table-cell-role="th">s_PlayAI.1</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">b_final_result</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>187.0</td>
<td>40.0</td>
<td>10.0</td>
<td>31.0</td>
<td>19.0</td>
<td>3.0</td>
<td>1.0</td>
<td>2.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699388451 Buyer: Hi there! I believe I receiv...</td>
<td>3.0</td>
<td>1.0</td>
<td>O</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>187.0</td>
<td>50.0</td>
<td>8.0</td>
<td>30.0</td>
<td>12.0</td>
<td>2.0</td>
<td>5.0</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699389969 Buyer: Hello. I need you to make th...</td>
<td>2.0</td>
<td>6.0</td>
<td>R</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>187.0</td>
<td>80.0</td>
<td>0.0</td>
<td>20.0</td>
<td>0.0</td>
<td>1.0</td>
<td>3.0</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699392080 Buyer: I would prefer a refund as t...</td>
<td>2.0</td>
<td>5.0</td>
<td>X</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>187.0</td>
<td>40.0</td>
<td>30.0</td>
<td>20.0</td>
<td>10.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699392404 Buyer: I didn't receive the correct...</td>
<td>NaN</td>
<td>NaN</td>
<td>W</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>187.0</td>
<td>90.0</td>
<td>5.0</td>
<td>5.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>2.0</td>
<td>NaN</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699393461 Buyer: Hello! I need you to refund ...</td>
<td>3.0</td>
<td>0.0</td>
<td>W</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2868</td>
<td>161.0</td>
<td>15.0</td>
<td>20.0</td>
<td>25.0</td>
<td>40.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>5.0</td>
<td>because he responded genuinely</td>
<td>False</td>
<td>1718875387 Buyer: Hello i requesting for a par...</td>
<td>2.0</td>
<td>6.0</td>
<td>M</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2869</td>
<td>137.0</td>
<td>90.0</td>
<td>0.0</td>
<td>10.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>5.0</td>
<td>how he responded</td>
<td>False</td>
<td>1718875522 Buyer: Hello, I would like to recei...</td>
<td>0.0</td>
<td>1.0</td>
<td>Z</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2870</td>
<td>185.0</td>
<td>75.0</td>
<td>0.0</td>
<td>25.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1718875699 Buyer: I would like a refund, the b...</td>
<td>NaN</td>
<td>NaN</td>
<td>W</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2871</td>
<td>161.0</td>
<td>35.0</td>
<td>20.0</td>
<td>30.0</td>
<td>15.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>5.0</td>
<td>sentences were short and minimal information g...</td>
<td>False</td>
<td>1718876074 Buyer: Hey, I received my order and...</td>
<td>4.0</td>
<td>3.0</td>
<td>G</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2879</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>25.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>2.0</td>
<td>It souunded too good to be true yet so human a...</td>
<td>False</td>
<td>1718878682 Buyer: Hi there, thank you for send...</td>
<td>3.0</td>
<td>4.0</td>
<td>W</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>2106 rows × 52 columns</p>
</div>
</div>
</div>
</section>
<section id="save-final-valid-dataframe-to-csv-file" class="level1">
<h1>Save Final Valid Dataframe to CSV file</h1>
<section id="setting-final-dataframes" class="level3">
<h3 class="anchored" data-anchor-id="setting-final-dataframes"><strong>Setting Final dataframes</strong></h3>
<div id="cell-76" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>data_preprocessor.filterValidOutcomes()</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>data_preprocessor.getDataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI4u</th>
<th data-quarto-table-cell-role="th">s_PlayAI.1</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>187.0</td>
<td>40.0</td>
<td>10.0</td>
<td>31.0</td>
<td>19.0</td>
<td>3.0</td>
<td>1.0</td>
<td>2.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699388451 Buyer: Hi there! I believe I receiv...</td>
<td>3.0</td>
<td>1.0</td>
<td>[{'timestamp': 1699388451, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>187.0</td>
<td>50.0</td>
<td>8.0</td>
<td>30.0</td>
<td>12.0</td>
<td>2.0</td>
<td>5.0</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699389969 Buyer: Hello. I need you to make th...</td>
<td>2.0</td>
<td>6.0</td>
<td>[{'timestamp': 1699389969, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>187.0</td>
<td>80.0</td>
<td>0.0</td>
<td>20.0</td>
<td>0.0</td>
<td>1.0</td>
<td>3.0</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699392080 Buyer: I would prefer a refund as t...</td>
<td>2.0</td>
<td>5.0</td>
<td>[{'timestamp': 1699392080, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>187.0</td>
<td>40.0</td>
<td>30.0</td>
<td>20.0</td>
<td>10.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699392404 Buyer: I didn't receive the correct...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 1699392404, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>187.0</td>
<td>90.0</td>
<td>5.0</td>
<td>5.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>2.0</td>
<td>NaN</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699393461 Buyer: Hello! I need you to refund ...</td>
<td>3.0</td>
<td>0.0</td>
<td>[{'timestamp': 1699393461, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2866</td>
<td>161.0</td>
<td>50.0</td>
<td>10.0</td>
<td>15.0</td>
<td>25.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>The conversation was emotions and had typing e...</td>
<td>False</td>
<td>1718874750 Buyer: My product arrived broken , ...</td>
<td>1.0</td>
<td>2.0</td>
<td>[{'timestamp': 1718874750, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2869</td>
<td>161.0</td>
<td>15.0</td>
<td>20.0</td>
<td>25.0</td>
<td>40.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>because he responded genuinely</td>
<td>False</td>
<td>1718875387 Buyer: Hello i requesting for a par...</td>
<td>2.0</td>
<td>6.0</td>
<td>[{'timestamp': 1718875387, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2871</td>
<td>185.0</td>
<td>75.0</td>
<td>0.0</td>
<td>25.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1718875699 Buyer: I would like a refund, the b...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 1718875699, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2872</td>
<td>161.0</td>
<td>35.0</td>
<td>20.0</td>
<td>30.0</td>
<td>15.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>sentences were short and minimal information g...</td>
<td>False</td>
<td>1718876074 Buyer: Hey, I received my order and...</td>
<td>4.0</td>
<td>3.0</td>
<td>[{'timestamp': 1718876074, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2880</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>25.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>It souunded too good to be true yet so human a...</td>
<td>False</td>
<td>1718878682 Buyer: Hi there, thank you for send...</td>
<td>3.0</td>
<td>4.0</td>
<td>[{'timestamp': 1718878682, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>1736 rows × 53 columns</p>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data type of parsed_dialog: &lt;class 'list'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI4u</th>
<th data-quarto-table-cell-role="th">s_PlayAI.1</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>187.0</td>
<td>40.0</td>
<td>10.0</td>
<td>31.0</td>
<td>19.0</td>
<td>3.0</td>
<td>1.0</td>
<td>2.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699388451 Buyer: Hi there! I believe I receiv...</td>
<td>3.0</td>
<td>1.0</td>
<td>[{'timestamp': 1699388451, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>187.0</td>
<td>50.0</td>
<td>8.0</td>
<td>30.0</td>
<td>12.0</td>
<td>2.0</td>
<td>5.0</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699389969 Buyer: Hello. I need you to make th...</td>
<td>2.0</td>
<td>6.0</td>
<td>[{'timestamp': 1699389969, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>187.0</td>
<td>80.0</td>
<td>0.0</td>
<td>20.0</td>
<td>0.0</td>
<td>1.0</td>
<td>3.0</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699392080 Buyer: I would prefer a refund as t...</td>
<td>2.0</td>
<td>5.0</td>
<td>[{'timestamp': 1699392080, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>187.0</td>
<td>40.0</td>
<td>30.0</td>
<td>20.0</td>
<td>10.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699392404 Buyer: I didn't receive the correct...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 1699392404, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>187.0</td>
<td>90.0</td>
<td>5.0</td>
<td>5.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>2.0</td>
<td>NaN</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699393461 Buyer: Hello! I need you to refund ...</td>
<td>3.0</td>
<td>0.0</td>
<td>[{'timestamp': 1699393461, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2869</td>
<td>161.0</td>
<td>15.0</td>
<td>20.0</td>
<td>25.0</td>
<td>40.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>because he responded genuinely</td>
<td>False</td>
<td>1718875387 Buyer: Hello i requesting for a par...</td>
<td>2.0</td>
<td>6.0</td>
<td>[{'timestamp': 1718875387, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2870</td>
<td>137.0</td>
<td>90.0</td>
<td>0.0</td>
<td>10.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>how he responded</td>
<td>False</td>
<td>1718875522 Buyer: Hello, I would like to recei...</td>
<td>0.0</td>
<td>1.0</td>
<td>[{'timestamp': 1718875522, 'speaker': 'Buyer',...</td>
<td>2.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2871</td>
<td>185.0</td>
<td>75.0</td>
<td>0.0</td>
<td>25.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1718875699 Buyer: I would like a refund, the b...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 1718875699, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2872</td>
<td>161.0</td>
<td>35.0</td>
<td>20.0</td>
<td>30.0</td>
<td>15.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>sentences were short and minimal information g...</td>
<td>False</td>
<td>1718876074 Buyer: Hey, I received my order and...</td>
<td>4.0</td>
<td>3.0</td>
<td>[{'timestamp': 1718876074, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2880</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>25.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>It souunded too good to be true yet so human a...</td>
<td>False</td>
<td>1718878682 Buyer: Hi there, thank you for send...</td>
<td>3.0</td>
<td>4.0</td>
<td>[{'timestamp': 1718878682, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>2107 rows × 53 columns</p>
</div>
</div>
</div>
<div id="cell-77" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>data_preprocessor.filterMatches(<span class="st">'message'</span>, <span class="st">"I Walk Away"</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>data_preprocessor.getDataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI4u</th>
<th data-quarto-table-cell-role="th">s_PlayAI.1</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>187.0</td>
<td>40.0</td>
<td>10.0</td>
<td>31.0</td>
<td>19.0</td>
<td>3.0</td>
<td>1.0</td>
<td>2.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699388451 Buyer: Hi there! I believe I receiv...</td>
<td>3.0</td>
<td>1.0</td>
<td>[{'timestamp': 1699388451, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>187.0</td>
<td>50.0</td>
<td>8.0</td>
<td>30.0</td>
<td>12.0</td>
<td>2.0</td>
<td>5.0</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699389969 Buyer: Hello. I need you to make th...</td>
<td>2.0</td>
<td>6.0</td>
<td>[{'timestamp': 1699389969, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>187.0</td>
<td>80.0</td>
<td>0.0</td>
<td>20.0</td>
<td>0.0</td>
<td>1.0</td>
<td>3.0</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699392080 Buyer: I would prefer a refund as t...</td>
<td>2.0</td>
<td>5.0</td>
<td>[{'timestamp': 1699392080, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>187.0</td>
<td>40.0</td>
<td>30.0</td>
<td>20.0</td>
<td>10.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699392404 Buyer: I didn't receive the correct...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 1699392404, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>187.0</td>
<td>90.0</td>
<td>5.0</td>
<td>5.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>2.0</td>
<td>NaN</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699393461 Buyer: Hello! I need you to refund ...</td>
<td>3.0</td>
<td>0.0</td>
<td>[{'timestamp': 1699393461, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2869</td>
<td>161.0</td>
<td>15.0</td>
<td>20.0</td>
<td>25.0</td>
<td>40.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>because he responded genuinely</td>
<td>False</td>
<td>1718875387 Buyer: Hello i requesting for a par...</td>
<td>2.0</td>
<td>6.0</td>
<td>[{'timestamp': 1718875387, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2870</td>
<td>137.0</td>
<td>90.0</td>
<td>0.0</td>
<td>10.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>how he responded</td>
<td>False</td>
<td>1718875522 Buyer: Hello, I would like to recei...</td>
<td>0.0</td>
<td>1.0</td>
<td>[{'timestamp': 1718875522, 'speaker': 'Buyer',...</td>
<td>2.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2871</td>
<td>185.0</td>
<td>75.0</td>
<td>0.0</td>
<td>25.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1718875699 Buyer: I would like a refund, the b...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 1718875699, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2872</td>
<td>161.0</td>
<td>35.0</td>
<td>20.0</td>
<td>30.0</td>
<td>15.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>sentences were short and minimal information g...</td>
<td>False</td>
<td>1718876074 Buyer: Hey, I received my order and...</td>
<td>4.0</td>
<td>3.0</td>
<td>[{'timestamp': 1718876074, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2880</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>25.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>It souunded too good to be true yet so human a...</td>
<td>False</td>
<td>1718878682 Buyer: Hi there, thank you for send...</td>
<td>3.0</td>
<td>4.0</td>
<td>[{'timestamp': 1718878682, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>2107 rows × 53 columns</p>
</div>
</div>
</div>
<div id="cell-78" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the folder exists before saving</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Save DataFrame to CSV</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>data_preprocessor.saveToCSV(final_filepath)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">"/Users/mishkin/Desktop/Research/Convo_Kit/ConvoKit_Disputes/data/preprocessed_dyads.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data saved to /Users/mishkin/Desktop/Research/Convo_Kit/ConvoKit_Disputes/data/preprocessed_dyads.csv</code></pre>
</div>
</div>
<div id="cell-79" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> DataPreprocesser(final_filepath)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>display(test.getDataframe())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2107</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/mishkin/Desktop/Research/Convo_Kit/ConvoKit_Disputes/src/modules/DataPreprocesser.py:111: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value '1702723625' has dtype incompatible with float64, please explicitly cast to a compatible dtype first.
  self.utterancesDF.loc[13988, 'timestamp']= '1702723625'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI4u</th>
<th data-quarto-table-cell-role="th">s_PlayAI.1</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>187.0</td>
<td>40.0</td>
<td>10.0</td>
<td>31.0</td>
<td>19.0</td>
<td>3.0</td>
<td>1.0</td>
<td>2.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699388451 Buyer: Hi there! I believe I receiv...</td>
<td>3.0</td>
<td>1.0</td>
<td>3</td>
<td>0</td>
<td>[{'timestamp': 1699388451, 'speaker': 'Buyer',...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>187.0</td>
<td>50.0</td>
<td>8.0</td>
<td>30.0</td>
<td>12.0</td>
<td>2.0</td>
<td>5.0</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699389969 Buyer: Hello. I need you to make th...</td>
<td>2.0</td>
<td>6.0</td>
<td>3</td>
<td>0</td>
<td>[{'timestamp': 1699389969, 'speaker': 'Buyer',...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>187.0</td>
<td>80.0</td>
<td>0.0</td>
<td>20.0</td>
<td>0.0</td>
<td>1.0</td>
<td>3.0</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699392080 Buyer: I would prefer a refund as t...</td>
<td>2.0</td>
<td>5.0</td>
<td>1</td>
<td>0</td>
<td>[{'timestamp': 1699392080, 'speaker': 'Buyer',...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>187.0</td>
<td>40.0</td>
<td>30.0</td>
<td>20.0</td>
<td>10.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699392404 Buyer: I didn't receive the correct...</td>
<td>NaN</td>
<td>NaN</td>
<td>3</td>
<td>0</td>
<td>[{'timestamp': 1699392404, 'speaker': 'Buyer',...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>187.0</td>
<td>90.0</td>
<td>5.0</td>
<td>5.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>2.0</td>
<td>NaN</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699393461 Buyer: Hello! I need you to refund ...</td>
<td>3.0</td>
<td>0.0</td>
<td>1</td>
<td>0</td>
<td>[{'timestamp': 1699393461, 'speaker': 'Buyer',...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2102</td>
<td>161.0</td>
<td>15.0</td>
<td>20.0</td>
<td>25.0</td>
<td>40.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>because he responded genuinely</td>
<td>False</td>
<td>1718875387 Buyer: Hello i requesting for a par...</td>
<td>2.0</td>
<td>6.0</td>
<td>3</td>
<td>0</td>
<td>[{'timestamp': 1718875387, 'speaker': 'Buyer',...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2103</td>
<td>137.0</td>
<td>90.0</td>
<td>0.0</td>
<td>10.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>how he responded</td>
<td>False</td>
<td>1718875522 Buyer: Hello, I would like to recei...</td>
<td>0.0</td>
<td>1.0</td>
<td>2</td>
<td>1</td>
<td>[{'timestamp': 1718875522, 'speaker': 'Buyer',...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2104</td>
<td>185.0</td>
<td>75.0</td>
<td>0.0</td>
<td>25.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1718875699 Buyer: I would like a refund, the b...</td>
<td>NaN</td>
<td>NaN</td>
<td>1</td>
<td>0</td>
<td>[{'timestamp': 1718875699, 'speaker': 'Buyer',...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2105</td>
<td>161.0</td>
<td>35.0</td>
<td>20.0</td>
<td>30.0</td>
<td>15.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>5.0</td>
<td>sentences were short and minimal information g...</td>
<td>False</td>
<td>1718876074 Buyer: Hey, I received my order and...</td>
<td>4.0</td>
<td>3.0</td>
<td>3</td>
<td>0</td>
<td>[{'timestamp': 1718876074, 'speaker': 'Buyer',...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2106</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>25.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>It souunded too good to be true yet so human a...</td>
<td>False</td>
<td>1718878682 Buyer: Hi there, thank you for send...</td>
<td>3.0</td>
<td>4.0</td>
<td>1</td>
<td>0</td>
<td>[{'timestamp': 1718878682, 'speaker': 'Buyer',...</td>
</tr>
</tbody>
</table>

<p>2107 rows × 53 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="save-final-dataframe-based-on-b_final_results-labels" class="level1">
<h1>Save Final Dataframe based on “b_final_results” Labels</h1>
<div id="cell-81" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>label_path <span class="op">=</span> <span class="st">"/Users/mishkin/Desktop/Research/Convo_Kit/ConvoKit_Disputes/data/alldyads_labels.csv"</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>filepath <span class="op">=</span> <span class="st">'/Users/mishkin/Desktop/Research/Convo_Kit/ConvoKit_Disputes/data/alldyads.csv'</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> DataPreprocesser(filepath, label_path<span class="op">=</span> label_path)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>display(df2.getDataframe())</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> DataPreprocesser(filepath)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>display(test.getDataframe())</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>final_path <span class="op">=</span> <span class="st">"/Users/mishkin/Desktop/Research/Convo_Kit/ConvoKit_Disputes/data/preprocessed_dyads_labels.csv"</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>df2.saveToCSV(final_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2882</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
<th data-quarto-table-cell-role="th">b_final_result</th>
<th data-quarto-table-cell-role="th">labeled_dispute_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>187.0</td>
<td>40.0</td>
<td>10.0</td>
<td>31.0</td>
<td>19.0</td>
<td>3.0</td>
<td>1.0</td>
<td>2.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1699388451 Buyer: Hi there! I believe I receiv...</td>
<td>3.0</td>
<td>1.0</td>
<td>[{'timestamp': 1699388451, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>O</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>187.0</td>
<td>50.0</td>
<td>8.0</td>
<td>30.0</td>
<td>12.0</td>
<td>2.0</td>
<td>5.0</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1699389969 Buyer: Hello. I need you to make th...</td>
<td>2.0</td>
<td>6.0</td>
<td>[{'timestamp': 1699389969, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>R</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>187.0</td>
<td>80.0</td>
<td>0.0</td>
<td>20.0</td>
<td>0.0</td>
<td>1.0</td>
<td>3.0</td>
<td>4.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1699392080 Buyer: I would prefer a refund as t...</td>
<td>2.0</td>
<td>5.0</td>
<td>[{'timestamp': 1699392080, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
<td>X</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>187.0</td>
<td>40.0</td>
<td>30.0</td>
<td>20.0</td>
<td>10.0</td>
<td>2.0</td>
<td>3.0</td>
<td>3.0</td>
<td>NaN</td>
<td>4.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1699392404 Buyer: I didn't receive the correct...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 1699392404, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>W</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>187.0</td>
<td>90.0</td>
<td>5.0</td>
<td>5.0</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>2.0</td>
<td>NaN</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1699393461 Buyer: Hello! I need you to refund ...</td>
<td>3.0</td>
<td>0.0</td>
<td>[{'timestamp': 1699393461, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
<td>W</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2868</td>
<td>161.0</td>
<td>15.0</td>
<td>20.0</td>
<td>25.0</td>
<td>40.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>because he responded genuinely</td>
<td>False</td>
<td>1718875387 Buyer: Hello i requesting for a par...</td>
<td>2.0</td>
<td>6.0</td>
<td>[{'timestamp': 1718875387, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>M</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2869</td>
<td>137.0</td>
<td>90.0</td>
<td>0.0</td>
<td>10.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>how he responded</td>
<td>False</td>
<td>1718875522 Buyer: Hello, I would like to recei...</td>
<td>0.0</td>
<td>1.0</td>
<td>[{'timestamp': 1718875522, 'speaker': 'Buyer',...</td>
<td>2.0</td>
<td>1.0</td>
<td>Z</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2870</td>
<td>185.0</td>
<td>75.0</td>
<td>0.0</td>
<td>25.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>1718875699 Buyer: I would like a refund, the b...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 1718875699, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
<td>W</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2871</td>
<td>161.0</td>
<td>35.0</td>
<td>20.0</td>
<td>30.0</td>
<td>15.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>sentences were short and minimal information g...</td>
<td>False</td>
<td>1718876074 Buyer: Hey, I received my order and...</td>
<td>4.0</td>
<td>3.0</td>
<td>[{'timestamp': 1718876074, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
<td>G</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2879</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>25.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>It souunded too good to be true yet so human a...</td>
<td>False</td>
<td>1718878682 Buyer: Hi there, thank you for send...</td>
<td>3.0</td>
<td>4.0</td>
<td>[{'timestamp': 1718878682, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
<td>W</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>2106 rows × 55 columns</p>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2882</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b_country</th>
<th data-quarto-table-cell-role="th">b_RankBuy_1</th>
<th data-quarto-table-cell-role="th">b_RankBuy_2</th>
<th data-quarto-table-cell-role="th">b_RankBuy_3</th>
<th data-quarto-table-cell-role="th">b_RankBuy_4</th>
<th data-quarto-table-cell-role="th">b_Tact_1</th>
<th data-quarto-table-cell-role="th">b_Tact_2</th>
<th data-quarto-table-cell-role="th">b_Tact_3</th>
<th data-quarto-table-cell-role="th">b_Tact_4</th>
<th data-quarto-table-cell-role="th">b_Tact_5</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">s_AI4u</th>
<th data-quarto-table-cell-role="th">s_PlayAI.1</th>
<th data-quarto-table-cell-role="th">s_AI-cues.1</th>
<th data-quarto-table-cell-role="th">is_AI</th>
<th data-quarto-table-cell-role="th">formattedChat</th>
<th data-quarto-table-cell-role="th">b_insight</th>
<th data-quarto-table-cell-role="th">s_insight</th>
<th data-quarto-table-cell-role="th">parsed_dialog</th>
<th data-quarto-table-cell-role="th">flag_speaker</th>
<th data-quarto-table-cell-role="th">dispute_outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>187.0</td>
<td>80.0</td>
<td>12.0</td>
<td>5.0</td>
<td>3.0</td>
<td>1.0</td>
<td>4.0</td>
<td>5.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>187.0</td>
<td>40.0</td>
<td>10.0</td>
<td>31.0</td>
<td>19.0</td>
<td>3.0</td>
<td>1.0</td>
<td>2.0</td>
<td>NaN</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>False</td>
<td>1699388451 Buyer: Hi there! I believe I receiv...</td>
<td>3.0</td>
<td>1.0</td>
<td>[{'timestamp': 1699388451, 'speaker': 'Buyer',...</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>187.0</td>
<td>40.0</td>
<td>10.0</td>
<td>30.0</td>
<td>20.0</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>NaN</td>
<td>3.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Buyer: Your response is utterly unacceptab...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Buyer', 'mes...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Buyer: Your response is utterly unacceptab...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Buyer', 'mes...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2877</td>
<td>161.0</td>
<td>50.0</td>
<td>10.0</td>
<td>20.0</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2878</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>30.0</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2879</td>
<td>185.0</td>
<td>50.0</td>
<td>10.0</td>
<td>30.0</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2880</td>
<td>185.0</td>
<td>60.0</td>
<td>10.0</td>
<td>25.0</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>2.0</td>
<td>It souunded too good to be true yet so human a...</td>
<td>False</td>
<td>1718878682 Buyer: Hi there, thank you for send...</td>
<td>3.0</td>
<td>4.0</td>
<td>[{'timestamp': 1718878682, 'speaker': 'Buyer',...</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2881</td>
<td>185.0</td>
<td>40.0</td>
<td>20.0</td>
<td>30.0</td>
<td>10.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>True</td>
<td>nan Seller: Your sudden demand for a refund is...</td>
<td>NaN</td>
<td>NaN</td>
<td>[{'timestamp': 'nan', 'speaker': 'Seller', 'me...</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>2882 rows × 53 columns</p>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data saved to /Users/mishkin/Desktop/Research/Convo_Kit/ConvoKit_Disputes/data/preprocessed_dyads_labels.csv</code></pre>
</div>
</div>
<section id="checking-if-custom-filtered-matched-provided-columns" class="level3">
<h3 class="anchored" data-anchor-id="checking-if-custom-filtered-matched-provided-columns">Checking if custom filtered matched provided columns</h3>
<div id="cell-83" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> data_preprocessor.getDataframe()</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>df2<span class="op">=</span> df2.getDataframe()</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>on_columns <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(df1.columns) <span class="op">&amp;</span> <span class="bu">set</span>(df2.columns))</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop duplicates to avoid false mismatches if needed</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>df1_clean <span class="op">=</span> df1[on_columns].drop_duplicates().copy()</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>df2_clean <span class="op">=</span> df2[on_columns].drop_duplicates().copy()</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Find rows in df1 not in df2</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>only_in_df1 <span class="op">=</span> df1_clean.merge(df2_clean, on<span class="op">=</span>on_columns, how<span class="op">=</span><span class="st">'left'</span>, indicator<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>only_in_df1 <span class="op">=</span> only_in_df1[only_in_df1[<span class="st">'_merge'</span>] <span class="op">==</span> <span class="st">'left_only'</span>]</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>only_in_df1 <span class="op">=</span> df1[df1[on_columns].<span class="bu">apply</span>(<span class="bu">tuple</span>, axis<span class="op">=</span><span class="dv">1</span>).isin(only_in_df1[on_columns].<span class="bu">apply</span>(<span class="bu">tuple</span>, axis<span class="op">=</span><span class="dv">1</span>))]</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Find rows in df2 not in df1</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>only_in_df2 <span class="op">=</span> df2_clean.merge(df1_clean, on<span class="op">=</span>on_columns, how<span class="op">=</span><span class="st">'left'</span>, indicator<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>only_in_df2 <span class="op">=</span> only_in_df2[only_in_df2[<span class="st">'_merge'</span>] <span class="op">==</span> <span class="st">'left_only'</span>]</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>only_in_df2 <span class="op">=</span> df2[df2[on_columns].<span class="bu">apply</span>(<span class="bu">tuple</span>, axis<span class="op">=</span><span class="dv">1</span>).isin(only_in_df2[on_columns].<span class="bu">apply</span>(<span class="bu">tuple</span>, axis<span class="op">=</span><span class="dv">1</span>))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>